System.register("chunks:///_virtual/UIParentComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./BaseComponent.ts"],(function(t){"use strict";var n,e,o,r;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator},function(t){r=t.BaseComponent}],execute:function(){var s;e._RF.push({},"021ddaLy3FFoKt6RJ0gmJVK","UIParentComponent",void 0);var c=o.ccclass;o.property,t("UIParentComponent",c("UIParentComponent")(s=function(t){function e(){return t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){},e}(r))||s);e._RF.pop()}}}));

System.register("chunks:///_virtual/MapController.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MainGame.ts","./LandInfoTipsComponent.ts","./SLightComponent.ts","./LisaCityInfoTipsComponent.ts"],(function(t){"use strict";var o,n,e,i,a,s,l,h,c,g,d,r,p,u,f,y;return{setters:[function(t){o=t.defineProperty},function(t){n=t.cclegacy,e=t.find,i=t.TiledMap,a=t.resources,s=t.Input,l=t.Vec2,h=t.Prefab,c=t.instantiate,g=t.Vec3,d=t.UITransform,r=t.clamp},function(t){p=t.MainGame},function(t){u=t.LandInfoTipsComponent},function(t){f=t.SLightComponent},function(t){y=t.LisaCityInfoTipsComponent}],execute:function(){n._RF.push({},"07a9aKaoKBJIIFuQKuYKGUx","MapController",void 0);var m=t("MapController",function(){function t(){}return t.init=function(){var o=this;this.mapInput=p.find("MapInput"),this.mapGroup=e("MapGroup",this.mapInput),this.uIParent=p.find("UIParent"),this.basePosYRange=this.oneMapHeight*this.minScale,this.mapTiled=e("Map1/Tiled",this.mapGroup).getComponent(i);var n=this.mapInput;a.load("Json/language/"+p.language,(function(t,n){t?console.log(t):o.languageDic=n.json})),a.load("Json/MapData/map",(function(n,e){if(n)console.log(n);else{for(var i=e.json.townlist,a=0;a<i.length;a++){var s=i[a],l="x_"+s.posx+"_y_"+s.posy,h=[];o.worldTowns[l]&&(h=o.worldTowns[l]),h[h.length]=s,o.worldTowns[l]=h,o.worldTownsWithTownId[s.id+""]=s,o.allWorldTownId.push(s.id+"");var c=[];o.belongTowns[s.belong]&&(c=o.belongTowns[s.belong]),c[c.length]=s,o.belongTowns[s.belong]=c}o.loadDataFinish=o.loadDataFinish+1,t.setLisaCityBg(),console.log("this.worldTowns =",o.worldTowns),console.log("this.belongTowns =",o.belongTowns)}})),a.load("Json/MapData/cityname",(function(t,n){if(console.log("err, data = ",t,n),t)console.log(t);else for(var e=n.json.list,i=0;i<e.length;i++){var a=e[i];o.cityNameMap[a.id]=a.name}})),a.load("Json/MapData/city",(function(n,e){if(n)console.log(n);else{var i=e.json.citylist;if(i){for(var a=0;a<i.length;a++){var s=i[a];o.cityInfo[s.id]=s}o.loadDataFinish=o.loadDataFinish+1,t.setLisaCityBg()}}})),a.load("Json/MapData/landpos",(function(t,n){t?console.log(t):(o.saledLandData=n.json,a.load("Json/MapData/webmap_buchang_5016",(function(t,n){if(t)console.log(t);else{var e=n.json;if(e)for(var i in e)o.saledLandData[i]||(o.saledLandData[i]=e[i])}})))})),a.load("Json/lisaHomeData/lisaData",(function(n,e){if(n)console.log(n);else{for(var i=e.json,a=0;a<i.length;a++){var s=i[a];o.lisaData[s.cityId]=s}o.loadDataFinish=o.loadDataFinish+1,t.setLisaCityBg()}})),n.on(s.EventType.TOUCH_START,(function(t){var n=t.getAllTouches();2==n.length&&(o.lastTouchPos1&&o.lastTouchPos2||(o.lastTouchPos1=new l(0,0),o.lastTouchPos2=new l(0,0)),o.lastTouchPos1.x=n[0].getLocationX(),o.lastTouchPos1.y=n[0].getLocationY(),o.lastTouchPos2.x=n[1].getLocationX(),o.lastTouchPos2.y=n[1].getLocationY())})),n.on(s.EventType.TOUCH_MOVE,(function(t){var n=t.getAllTouches(),e=n.length;if(1==e)o.move(t.getDeltaX(),t.getDeltaY());else if(2==e){var i=n[0].getLocationX(),a=n[0].getLocationY(),s=n[1].getLocationX(),l=n[1].getLocationY(),h=(Math.sqrt(Math.pow(i-s,2)+Math.pow(a-l,2))-Math.sqrt(Math.pow(o.lastTouchPos1.x-o.lastTouchPos2.x,2)+Math.pow(o.lastTouchPos1.y-o.lastTouchPos2.y,2)))/(screen.height/o.touchBaseHeight)*o.touchZoomRate;o.scale(h,(n[0].getUILocationX()+n[1].getUILocationX())/2,(n[0].getUILocationY()+n[1].getUILocationY())/2),o.lastTouchPos1.x=i,o.lastTouchPos1.y=a,o.lastTouchPos2.x=s,o.lastTouchPos2.y=l}(Math.abs(t.getDeltaX())>=1||Math.abs(t.getDeltaY())>=1)&&(o.isDrag=!0)})),n.on(s.EventType.MOUSE_WHEEL,(function(t){o.scale(o.mouseWheelRate*t.getScrollY(),t.getUILocationX(),t.getUILocationY())})),n.on(s.EventType.TOUCH_END,(function(t){if(!o.isDrag){var n=t.getUILocation(),e=o.getMapTownPos(n.x,n.y);o.transferToTilePos(e),console.log("城镇左上角坐标:   ",t.getAllTouches().length,e);var i="x_"+e.x+"_y_"+e.y,a=o.worldTowns[i];if(!a)return void console.log("当前点击的不是城镇图标",e);o.getDataAndShowCityTipsFromClick(a)}o.isDrag=!1}))},t.setLisaCityBg=function(){var t=this;if(3==this.loadDataFinish){for(var o in this.lisaData)Object.prototype.hasOwnProperty.call(this.lisaData,o)&&function(){var n=t.lisaData[o],e=t.belongTowns[n.cityId][0],i=t.cityInfo[n.cityId],s=t.getCityFirstTownPos(e.id,i);if(s){var l=i.level,g="Prefab/slight_pink_"+l;a.load(g,h,(function(o,e){if(o)console.log(o);else for(var i=-1;i<=1;i++){var a=s.x+i*t.oneMapWidth,h=s.y,g=c(e);1==l?(t.mapGroup.addChild(g),g.setPosition(a+38,h-38)):2==l&&(t.mapGroup.addChild(g),g.setPosition(a+19,h-19)),g.getComponent(f).setLisaData(n),t.lisaHomeNodes[a+"_"+h]=g}}))}}();console.log("set lisa home bg finish")}},t.getPosYRange=function(){this.getPosYRangeV2||(this.getPosYRangeV2=new l(0,0));var t=(this.mapGroup.scale.x*this.oneMapHeight-this.basePosYRange)/2;return t<=0?(this.getPosYRangeV2.x=0,this.getPosYRangeV2.y=0):(this.getPosYRangeV2.x=t,this.getPosYRangeV2.y=-t),this.getPosYRangeV2},t.getMapTownPos=function(t,o){this.getMapTownPosInV3&&this.getMapTownPosOutV3||(this.getMapTownPosInV3=new g(0,0,0),this.getMapTownPosOutV3=new g(0,0,0)),this.getMapTownPosInV3.x=t,this.getMapTownPosInV3.y=o,this.mapGroup.getComponent(d).convertToNodeSpaceAR(this.getMapTownPosInV3,this.getMapTownPosOutV3);var n=(this.getMapTownPosOutV3.x+this.halfOneMapWidth)%this.oneMapWidth,e=(this.getMapTownPosOutV3.y+this.halfOneMapHeight)%this.oneMapHeight;return n<0&&(n+=this.oneMapWidth),e<0&&(e+=this.oneMapHeight),e=this.oneMapHeight-e,this.getMapTownPosOutV3.x=n,this.getMapTownPosOutV3.y=e,this.getMapTownPosOutV3},t.getPosXRange=function(){this.getPosXRangeV2||(this.getPosXRangeV2=new l(0,0));var t=this.mapGroup.scale.x*this.oneMapWidth-100;return this.getPosXRangeV2.x=t,this.getPosXRangeV2.y=-t,this.getPosXRangeV2},t.move=function(t,o){console.log("deltaX,deltaY",t,o);var n=this.mapGroup.position.x+t,e=this.mapGroup.position.y+o,i=this.getPosYRange();e=r(e,i.y,i.x);var a=this.getPosXRange();n>a.x?n-=a.x:n<a.y&&(n-=a.y),this.mapGroup.setPosition(n,e,0)},t.scale=function(t,o,n){this.scaleInV3&&this.scaleOutV3||(this.scaleInV3=new g(0,0,0),this.scaleOutV3=new g(0,0,0)),this.scaleInV3.x=o,this.scaleInV3.y=n,this.mapGroup.getComponent(d).convertToNodeSpaceAR(this.scaleInV3,this.scaleOutV3);var e=this.mapGroup.scale.x;t=r(t+=e,this.minScale,this.maxScale),this.mapGroup.setScale(t,t,t);var i=this.mapGroup.scale.x-e,a=0,s=0;this.scaleOutV3.x<0?a=1:this.scaleOutV3.x>0&&(a=-1),this.scaleOutV3.y<0?s=1:this.scaleOutV3.y>0&&(s=-1),this.move(a*i*this.halfOneMapWidth*Math.abs(this.scaleOutV3.x/this.halfOneMapWidth),s*i*this.halfOneMapHeight*Math.abs(this.scaleOutV3.y/this.halfOneMapHeight))},t.transferToTilePos=function(t){var o=this.mapTiled.getTileSize();t.x=Math.floor(t.x/o.x),t.y=Math.floor(t.y/o.y)},t.getDataAndShowCityTipsFromClick=function(t){var o=this.cityInfo[t[0].belong];t[0].id;console.log("city = ",o,t),this.getDataAndShowCityTips(o.id,(function(){}))},t.getDataAndShowCityTips=function(o,n){var e=this,i=this.cityInfo[o];if(i){var s="Titan",l="",g=600,d="1st class city",r="",p=this.belongTowns[o][0].id;if(i){l=i.id,1==i.level?d="1st class city":(d="2nd class city",g=300),(r=this.cityNameMap[l])||(r=l+" City"),t.resetCityInfoState();var u=i.level,f=t.getCityFirstTownPos(p,i),m=this.lisaData[l+""];m?t.showLisaCityInfo(!0,s,r,g,d,i,m,u,f,n):a.load("Prefab/LisaCityTips",h,(function(o,a){if(o)console.log(o);else{e.mCityInfo=c(a);var l=e.mCityInfo.getComponent(y);l.updateData(!1,"",s,r,g+"",d,i.level,"","","","","",""),l.callback=n,e.uIParent.addChild(e.mCityInfo),e.setTouchMove(e.mCityInfo),t.setCityBlockBg(u,f)}}))}}else console.log("not find city cityId=",o)},t.setCityBlockBg=function(t,o){var n=this;1==t?a.load("Prefab/mapYellowClickBg",h,(function(t,e){t?console.log(t):(n.mClickCityBgNode=c(e),n.mapGroup.addChild(n.mClickCityBgNode),n.mClickCityBgNode.setPosition(o.x+38,o.y-38))})):a.load("Prefab/mapWhiteClickBg",h,(function(t,e){t?console.log(t):(n.mClickCityBgNode=c(e),n.mapGroup.addChild(n.mClickCityBgNode),n.mClickCityBgNode.setPosition(o.x+19,o.y-19))}))},t.showLisaCityInfo=function(t,o,n,e,i,s,l,g,d,r){var p=this;a.load("Prefab/LisaCityTips",h,(function(t,a){if(t)console.log(t);else{p.mCityInfo=c(a);var h=p.mCityInfo.getComponent(y);h.updateData(!0,"",o,n,e+"",i,s.level,l.tokenID,l.landLevel,l.townName,l.landNo,l.landPosx,l.landPosy),h.callback=r,p.uIParent.addChild(p.mCityInfo),p.setTouchMove(p.mCityInfo)}}))},t.resetCityInfoState=function(){this.clickNodeOfSLightComponent&&(this.clickNodeOfSLightComponent.reset(),this.clickNodeOfSLightComponent=null),this.mLandInfoTipsComponent&&(this.mLandInfoTipsComponent.reset(),this.mLandInfoTipsComponent=null),this.mTokenIdButtonComponent&&(this.mTokenIdButtonComponent.reset(),this.mTokenIdButtonComponent=null),this.mCityInfo&&(this.mCityInfo.removeFromParent(),this.mCityInfo.destroy(),this.mCityInfo=null),this.mClickCityBgNode&&(this.mClickCityBgNode.removeFromParent(),this.mClickCityBgNode.destroy(),this.mClickCityBgNode=null)},t.getDataAndShowLandTips=function(t,o,n){var e=this,i=this.saledLandData[t+""];if(i){var s=i.townid,l=this.townLands[s];if(l){var h=l["x_"+i.landx+"_y_"+i.landy];this.showLandTips(t,h,o,n)}else a.load("Json/Land/"+s,(function(a,l){if(a)console.log("err = ",a);else{for(var h={},c=l.json,g=0;g<c.length;g++){var d=c[g];h["x_"+d.posx+"_y_"+d.posy]=d}e.townLands[s]=h;var r="x_"+i.landx+"_y_"+i.landy,p=e.townLands[s][r];e.showLandTips(t,p,o,n)}}))}else console.log("not found the saledLandData by tokenId: ",t)},t.showLandTips=function(t,o,n,e){var i=this;if(o){var s=o.townid,l=o.posx,g=o.posy,d=(o.cityid,this.cityNameMap[o.cityid]);d&&d+" , "+o.townid+"Town",d||(d=o.cityid+" City");var r="2",p=this.cityInfo[o.cityid];if(n)this.createLightNode(t,s,p,e);else{p&&(r=1==p.level?"1":"2");var y="B";1==o.level?y="S":2==o.level&&(y="A");var m=o.id.toString(16),T=(m=parseInt(m.substring(m.length-4),16))%150;0==T&&(T=150);var C="X:"+o.posx+"/Y:"+o.posy,v="https://static-download2.metacitym.com"+o.imageurl;console.log("hello land:townId,cityid,cityName,cityLevel,landId,landLevel,landPos,landUrl=",s,o.cityid,d,r,T,y,C,v);var I=new Map([["PLANET","Titan"],["CITY LEVEL",r],["LAND LEVEL",y],["CITY",d],["TOWN",s+"Town"],["LAND NO",T+""],["LAND POSX",l+""],["LAND POSY",g+""],["LAND SIZE","40*30"],["LAND NAME",""]]);if(e)return void e(t,v,I);var P=this.lightPosWithTokenId[t];if(P){a.load("Prefab/nfts_bg",h,(function(o,n){o?console.log(o):(i.mCityInfo=c(n),i.mLandInfoTipsComponent=i.mCityInfo.getComponent(u),i.mLandInfoTipsComponent.updateDatas(t+"",v,I),i.uIParent.addChild(i.mCityInfo),i.setTouchMove(i.mCityInfo))}));var w=P.x+"_"+P.y,M=this.lightPosWithLightNode[w];M&&M.getComponent(f).doClick()}}}else console.log("not found the town land")},t.createLightNode=function(o,n,e,i){var s=this;if(this.worldTownsWithTownId[n]){var l=e.level,g=t.getCityFirstTownPos(n,e);this.lightPosWithTokenId[o]=g;var d=this.lisaData[e.id+""];if(this.lightPosWithLightNode[g.x+"_"+g.y]){for(var r=-1;r<=1;r++){var p=g.x+r*this.oneMapWidth,u=g.y,y=this.lightPosWithLightNode[p+"_"+u];d?y.getComponent(f).addTokenId(o,3):y.getComponent(f).addTokenId(o,l)}return void i()}if(d){console.log("start lisa flash tokenId="+o);for(var m=-1;m<=1;m++){var T=g.x+m*this.oneMapWidth,C=g.y,v=this.lisaHomeNodes[T+"_"+C];v.getComponent(f).startFlash(),v.getComponent(f).addTokenId(o,3),this.lightPosWithLightNode[T+"_"+C]=v}return void i()}var I="Prefab/slight"+l;a.load(I,h,(function(t,n){if(t)console.log(t);else{for(var e=-1;e<=1;e++){var a=g.x+e*s.oneMapWidth,h=g.y,d=c(n);s.mapGroup.addChild(d),1==l?(d.setPosition(a+38,h-38),d.getComponent(f).addTokenId(o,l)):(d.setPosition(a+19,h-19),d.getComponent(f).addTokenId(o,l)),s.lightPosWithLightNode[a+"_"+h]=d}i()}}))}else console.log("找不到townInfo townId="+n),i()},t.getCityFirstTownPos=function(t,o){if(null==t||null==o)return null;var n=this.worldTownsWithTownId[t],e=n.posx,i=n.posy;o.level;if(1==o.level){var a=this.belongTowns[n.belong][0];a&&(e=a.posx,i=a.posy)}return this.getUIPosByTownPos(e,i)},t.testCreateAllLight=function(){this.worldTownsWithTownId},t.getUIPosByTownPos=function(t,o){var n=new g(0,0,0),e=this.mapTiled.getTileSize(),i=e.x*t,a=e.y*o;return a=this.oneMapHeight-a,n.x=i-this.halfOneMapWidth,n.y=a-this.halfOneMapHeight,n},t.canMove=function(){return!(this.mCityInfo||!this.mapCanMove)},t.canScale=function(){return!(this.mCityInfo||!this.mapCanScale)},t.setTouchMove=function(t){var o=this;t&&t.on(s.EventType.TOUCH_MOVE,(function(n){1==n.getAllTouches().length&&o.alertViewMove(t,n.getDeltaX(),n.getDeltaY())}))},t.alertViewMove=function(t,o,n){console.log("deltaX,deltaY",o,n);var e=t.position.x+o,i=t.position.y+n;t.setPosition(e,i,0)},t}());o(m,"mapInput",null),o(m,"mapGroup",null),o(m,"uIParent",null),o(m,"mapTiled",null),o(m,"oneMapWidth",6498),o(m,"oneMapHeight",3724),o(m,"halfOneMapWidth",3249),o(m,"halfOneMapHeight",1862),o(m,"mapCount",3),o(m,"minScale",.2),o(m,"maxScale",1.8),o(m,"basePosYRange",0),o(m,"mouseWheelRate",1e-4),o(m,"touchZoomRate",.0012),o(m,"touchBaseHeight",1080),o(m,"lastTouchPos1",null),o(m,"lastTouchPos2",null),o(m,"isDrag",!1),o(m,"worldTowns",{}),o(m,"worldTownsWithTownId",{}),o(m,"allWorldTownId",[]),o(m,"belongTowns",{}),o(m,"cityInfo",{}),o(m,"cityNameMap",{}),o(m,"saledLandData",{}),o(m,"townLands",{}),o(m,"lisaData",{}),o(m,"lightPosNode",{}),o(m,"lightPosWithTokenId",{}),o(m,"lightPosWithLightNode",{}),o(m,"mCityInfo",null),o(m,"mClickCityBgNode",null),o(m,"loadDataFinish",0),o(m,"mapCanMove",!0),o(m,"mapCanScale",!0),o(m,"lisaHomeNodes",{}),o(m,"languageDic",{}),o(m,"clickNodeOfSLightComponent",null),o(m,"mLandInfoTipsComponent",null),o(m,"mTokenIdButtonComponent",null),o(m,"getPosYRangeV2",null),o(m,"getMapTownPosInV3",null),o(m,"getMapTownPosOutV3",null),o(m,"getPosXRangeV2",null),o(m,"scaleInV3",null),o(m,"scaleOutV3",null),n._RF.pop()}}}));

System.register("chunks:///_virtual/SPageViewComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var t,n,a,i,o,s,r,d;return{setters:[function(e){t=e.inheritsLoose,n=e.defineProperty,a=e.assertThisInitialized},function(e){i=e.cclegacy,o=e._decorator,s=e.find,r=e.PageView,d=e.Component}],execute:function(){var g;i._RF.push({},"14d99EhWsRJfLc7wJbEuXYv","SPageViewComponent",void 0);var h=o.ccclass;o.property,e("SPageViewComponent",h("SPageViewComponent")(g=function(e){function i(){for(var t,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return t=e.call.apply(e,[this].concat(o))||this,n(a(t),"mPageView",null),n(a(t),"lightTokenIds",[]),n(a(t),"tokenIdMapLandUrl",{}),n(a(t),"tokenIdMapCityInfo",{}),n(a(t),"pageNodes",[]),n(a(t),"xxCurrentPageIndex",0),n(a(t),"dataIndex",4),n(a(t),"handling",0),t}t(i,e);var o=i.prototype;return o.start=function(){s("view/content",this.node);this.mPageView=this.node.getComponent(r),this.pageNodes=this.mPageView.getPages()},o.update=function(e){this.handlePage()},o.callback=function(e,t){console.log(t)},o.handlePage=function(){var e=this.mPageView.getCurrentPageIndex();if(console.log("currentPageIndex=",e),e>this.xxCurrentPageIndex&&(this.dataIndex=this.dataIndex+1),e<this.xxCurrentPageIndex&&(this.dataIndex=this.dataIndex-1),1==e&&0==this.handling){this.handling=1;var t=this.pageNodes.shift();this.mPageView.removePage(t),this.mPageView.addPage(t),this.pageNodes.push(t),this.mPageView.setCurrentPageIndex(0),this.handling=0}},o.setData=function(e,t,n){this.lightTokenIds=e,this.tokenIdMapLandUrl=t,this.tokenIdMapCityInfo=n},i}(d))||g);i._RF.pop()}}}));

System.register("chunks:///_virtual/TokenIdModel.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,n,o;return{setters:[function(t){e=t.defineProperty},function(t){n=t.cclegacy,o=t._decorator}],execute:function(){var c;n._RF.push({},"1b7cd1lQ15DPZdl21IAA+kY","TokenIdModel",void 0);var s=o.ccclass;o.property,t("TokenIdModel",s("TokenIdModel")(c=function(){e(this,"ownerNfts",[]),e(this,"pageKey",""),e(this,"totalCount",0),e(this,"blockHash","")})||c),t("OwnerNft",(function(){e(this,"contract",null),e(this,"id",null),e(this,"balance","")})),t("Contract",(function(){e(this,"address","")})),t("Id",(function(){e(this,"tokenId","")}));n._RF.pop()}}}));

System.register("chunks:///_virtual/UIController.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MainGame.ts"],(function(e){"use strict";var t,n,r,a,i,o,c;return{setters:[function(e){t=e.defineProperty},function(e){n=e.cclegacy,r=e._decorator,a=e.resources,i=e.Prefab,o=e.instantiate},function(e){c=e.MainGame}],execute:function(){var l,s,u;n._RF.push({},"3b5f6XUzCBF87UiVZLCmNK4","UIController",void 0);var p=r.ccclass;r.property,e("UIController",p("UIController")((u=s=function(){function e(){}return e.init=function(){e.parent=c.find("UIParent")},e.create=function(e,t,n){var r=this,c=null;this.map.has(e)?(c=this.map.get(e),this.map.delete(e),n(c),c.active=!0):a.load("Prefab/"+e,i,(function(e,a){e?console.log(e):(c=o(a),t&&r.parent.addChild(c),n(c))}))},e.recycle=function(e){e.active=!1,this.map.set(e.name,e)},e}(),t(s,"parent",null),t(s,"map",new Map),l=u))||l);n._RF.pop()}}}));

System.register("chunks:///_virtual/LoginInfoComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MainGame.ts","./MapController.ts","./CUtil.ts","./BaseComponent.ts"],(function(t){"use strict";var e,n,o,i,s,a,l,r,c,d,h,u,g,f,p,I,m,k;return{setters:[function(t){e=t.inheritsLoose,n=t.defineProperty,o=t.assertThisInitialized,i=t.asyncToGenerator},function(t){s=t.cclegacy,a=t._decorator,l=t.find,r=t.Button,c=t.sys,d=t.resources,h=t.Prefab,u=t.instantiate,g=t.UITransform,f=t.Label},function(t){p=t.MainGame},function(t){I=t.MapController},function(t){m=t.CUtil},function(t){k=t.BaseComponent}],execute:function(){var v;s._RF.push({},"3d843/pR55AlqBfle6c61rL","LoginInfoComponent",void 0);var L=a.ccclass;a.property,t("LoginInfoComponent",L("LoginInfoComponent")(v=function(t){function s(){for(var e,s=arguments.length,a=new Array(s),l=0;l<s;l++)a[l]=arguments[l];return e=t.call.apply(t,[this].concat(a))||this,n(o(e),"tokenIdScrollView",null),n(o(e),"tokenIdScrollViewContentNode",null),n(o(e),"loginTokenInfoNode",null),n(o(e),"tipsLabelNode",null),n(o(e),"loadingLabelNode",null),n(o(e),"mParent",null),n(o(e),"buylandBtn",null),n(o(e),"ntfStartBtn",null),n(o(e),"loginButton",null),n(o(e),"logoutButton",null),n(o(e),"tokenIds",[]),n(o(e),"sleep",function(){var t=i(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){setTimeout(t,e)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),n(o(e),"orginWidget",null),n(o(e),"lightIndex",0),e}e(s,t);var a=s.prototype;return a.start=function(){this.initNode()},a.initNode=function(){var t=this;this.mParent=p.find("UIParent"),this.loginTokenInfoNode=this.node,this.buylandBtn=l("buyland",this.loginTokenInfoNode),this.ntfStartBtn=l("nft_start",this.loginTokenInfoNode),this.loginButton=l("loginButton",this.loginTokenInfoNode),this.logoutButton=l("logoutButton",this.loginTokenInfoNode),this.tokenIdScrollView=l("tokenScrollView",this.loginTokenInfoNode),this.tokenIdScrollViewContentNode=l("view/content",this.tokenIdScrollView),this.loadingLabelNode=l("loadingLabel",this.tokenIdScrollView),this.loadingLabelNode.active=!1,this.tipsLabelNode=l("noDataTips",this.tokenIdScrollView),this.tipsLabelNode.active=!1,this.tipsLabelNode.on(r.EventType.CLICK,(function(){c.openURL("https://metacitym.com/")}),this),this.buylandBtn.on(r.EventType.CLICK,(function(){c.openURL("https://metacitym.com/")}),this),this.ntfStartBtn.on(r.EventType.CLICK,(function(){p.isLogin()?t.tokenIdScrollView.active?t.tokenIdScrollView.active=!1:t.tokenIdScrollView.active=!0:location.href="https://metacitym.com/login/index.html?redirect=https://metacitym.com/map/"}),this),this.loginButton.on(r.EventType.CLICK,(function(){console.log("login click"),location.href="https://metacitym.com/login/index.html?redirect=https://metacitym.com/map/"}),this),this.logoutButton.on(r.EventType.CLICK,(function(){console.log("logout click"),location.href="https://metacitym.com/map/"}),this),this.initRequestData()},a.initRequestData=function(){p.isLogin()?(this.tokenIdScrollView.active=!0,this.loginButton.active=!1,this.logoutButton.active=!0,this.startRequestData()):(this.tokenIdScrollView.active=!1,this.loginButton.active=!0,this.logoutButton.active=!1)},a.startRequestData=function(){var t=i(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadingLabelNode.active=!0,t.next=3,this.sleep(1e3);case 3:this.requestTokenIds(p.address,null,1);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),a.createTokenIdView=function(){var t=this;console.log("createTokenIdView"),this.tokenIds.length>0?(this.tipsLabelNode.active=!1,d.load("Prefab/TokenIdItem",h,(function(e,n){e&&console.log(e),t.tokenIdScrollViewContentNode.removeAllChildren();var o=(u(n).getComponent(g).height+40)*(t.tokenIds.length/2+2);t.tokenIdScrollViewContentNode.getComponent(g).height=o,t.refreshTokenUi(n)})),this.showLightOnMap()):this.tipsLabelNode.active=!0},a.refreshTokenUi=function(t){for(var e=0;e<this.tokenIds.length;e++){var n=this.tokenIds[e],o=u(t);o.getChildByName("tokenIdLabel").getComponent(f).string=n+"",o.getComponent(r).clickEvents[0].customEventData=n+"",this.tokenIdScrollViewContentNode.addChild(o)}},a.showLightOnMap=function(){this.lightIndex=0,this.showLightOnMapLoop()},a.showLightOnMapLoop=function(){var t=this;if(this.tokenIds.length>0){var e=this.tokenIds[this.lightIndex];I.getDataAndShowLandTips(e,!0,(function(){t.lightIndex<t.tokenIds.length-1&&(t.lightIndex=t.lightIndex+1,t.showLightOnMapLoop())}))}},a.requestTokenIds=function(t,e,n){var o=this;if(1==n||e){var i="";i=1!=n&&e?"https://act.gamamobi.com/pre/nft/getTokenIds.web?owner="+t+"&pageKey="+e+"&contractAddress=0x82016d4ad050ef4784e282b82a746d3e01df23bf,0xa39853A45D0420D8dB0F660EA39dA1E89608fCfa&_="+Date.parse((new Date).toString()):"https://act.gamamobi.com/pre/nft/getTokenIds.web?owner="+t+"&contractAddress=0x82016d4ad050ef4784e282b82a746d3e01df23bf,0xa39853A45D0420D8dB0F660EA39dA1E89608fCfa&_="+Date.parse((new Date).toString()),m.httpPequest(i,(function(e){if(e){var i=JSON.parse(e),s=i.ownedNfts,a=i.pageKey;i.totalCount,i.blockHash;if(s)for(var l=0;l<s.length;l++){var r=s[l].id.tokenId,c=m.hex2Number(r);c&&r&&o.tokenIds.push(c)}a?o.requestTokenIds(t,a,2):(console.log("全部请求完成"),o.loadingLabelNode.active=!1,o.tokenIds.length>0&&o.tokenIds.sort((function(t,e){return t-e})),o.createTokenIdView()),console.log("解析完成 key="+a)}else console.log("request error:"+n),o.loadingLabelNode.active=!1,o.tipsLabelNode.active=!0}))}},s}(k))||v);s._RF.pop()}}}));

System.register("chunks:///_virtual/CUtil.ts",["cc","./MapController.ts"],(function(e){"use strict";var t,n,o,r,s;return{setters:[function(e){t=e.cclegacy,n=e._decorator,o=e.view,r=e.Vec3},function(e){s=e.MapController}],execute:function(){var i;t._RF.push({},"51648wVQwlFzoh7MuSIErH4","CUtil",void 0);var a=n.ccclass;n.property,e("CUtil",a("CUtil")(i=function(){function e(){}return e.getScaleRatio=function(){var e=o.getVisibleSizeInPixel(),t=o.getDesignResolutionSize(),n=e.width,s=e.height;if(console.log("nVisibleSizeInPixel =",e),console.log("nDesignResolutionSize =",t),s>n){var i=n/t.width;if(i<1)return new r(i,i,i)}return null},e.getLocalString=function(e){var t=s.languageDic[e];return t||e},e.getQueryVariable=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substring(1).match(t);return null!=n?decodeURI(n[2]):null},e.httpPequest=function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(console.log("onreadystatechange"),4==n.readyState&&n.status>=200&&n.status<400){var e=n.responseText;t(e)}},n.open("GET",e,!0),n.withCredentials=!0,n.send()},e.loadRequest=function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState&&n.status>=200&&n.status<400){var e=n.response;return console.log("loadRequest response:"+e),void t(e)}t(null)},n.open("GET",e,!0),n.withCredentials=!0,n.send()},e.httpPostPequest=function(e,t){var n=new XMLHttpRequest;n.timeout=5e3,n.open("POST",e,!0),n.setRequestHeader("Authorization","true"),n.onerror=function(e){console.log("onerror")},n.onreadystatechange=function(){4===n.readyState&&n.status>=200&&n.status<300?(console.log("success"),console.log(n.responseText)):console.log("fail")},n.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8");n.send("jQuery18206190064924153293_1646388734858&owner=0x2f2e99bcbe39D8407552E821e7F4F0F9592Dfcab&contractAddress=0x82016d4ad050ef4784e282b82a746d3e01df23bf&_=1646388740791")},e.hex2Number=function(e){return void 0===e&&(e=""),0===e.indexOf("0x")&&(e=e.slice(2)),parseInt("0x"+e,16)},e}())||i);t._RF.pop()}}}));

System.register("chunks:///_virtual/LandTipsNode2Component.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./LandInfoTipsComponent.ts","./MapController.ts","./BaseComponent.ts"],(function(t){"use strict";var n,e,o,i,s,a,l,c,r,h,p,d;return{setters:[function(t){n=t.inheritsLoose,e=t.defineProperty,o=t.assertThisInitialized},function(t){i=t.cclegacy,s=t._decorator,a=t.find,l=t.Button,c=t.Sprite,r=t.Color},function(t){h=t.LandInfoTipsComponent},function(t){p=t.MapController},function(t){d=t.BaseComponent}],execute:function(){var u;i._RF.push({},"550a6iIGkpCaoRV/fQjOrY5","LandTipsNode2Component",void 0);var C=s.ccclass;s.property,t("LandTipsNode2Component",C("LandTipsNode2Component")(u=function(t){function i(){for(var n,i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=t.call.apply(t,[this].concat(s))||this,e(o(n),"previous",null),e(o(n),"next",null),e(o(n),"closeBtn",null),e(o(n),"lightTokenIds",null),e(o(n),"landShowInfoNode",null),e(o(n),"index",0),e(o(n),"callback",null),n}n(i,t);var s=i.prototype;return s.start=function(){var n=this;if(t.prototype.start.call(this),this.previous=a("previous",this.node),this.next=a("next",this.node),this.closeBtn=a("btn_close",this.node),a("nfts_bg/closeButton",this.node).active=!1,this.landShowInfoNode=a("nfts_bg",this.node),this.closeBtn.on(l.EventType.CLICK,(function(){p.mapCanMove=!0,p.mapCanScale=!0,n.callback&&n.callback(1),n.node.removeFromParent(),n.node.destroy()})),this.previous.on(l.EventType.CLICK,(function(){n.index<0||(n.index=n.index-1,n.showData(n.lightTokenIds[n.index]),n.checkBtnStatue())})),this.next.on(l.EventType.CLICK,(function(){n.index>n.lightTokenIds.length-1||(n.index=n.index+1,n.showData(n.lightTokenIds[n.index]),n.checkBtnStatue())})),p.mapCanMove=!1,p.mapCanScale=!1,this.lightTokenIds.length>0){var e=this.lightTokenIds[0];this.showData(e)}this.checkBtnStatue()},s.setData=function(t){this.lightTokenIds=t},s.showData=function(t){var n=this;p.getDataAndShowLandTips(t,!1,(function(t,e,o){n.landShowInfoNode.getComponent(h).updateDatas(t+"",e,o)}))},s.checkBtnStatue=function(){0==this.index?(this.previous.getComponent(c).color=r.GRAY,this.previous.getComponent(l).interactable=!1):(this.previous.getComponent(c).color=r.WHITE,this.previous.getComponent(l).interactable=!0),this.index>=this.lightTokenIds.length-1?(this.next.getComponent(c).color=r.GRAY,this.next.getComponent(l).interactable=!1):(this.next.getComponent(c).color=r.WHITE,this.next.getComponent(l).interactable=!0)},i}(d))||u);i._RF.pop()}}}));

System.register("chunks:///_virtual/LandInfoTipsComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MapController.ts","./CUtil.ts","./BaseComponent.ts"],(function(t){"use strict";var e,n,o,i,a,r,l,s,d,c,p,u,f,h,m,N,g,v,C,L,_;return{setters:[function(t){e=t.inheritsLoose,n=t.defineProperty,o=t.assertThisInitialized,i=t.createForOfIteratorHelperLoose},function(t){a=t.cclegacy,r=t._decorator,l=t.find,s=t.Node,d=t.Label,c=t.Sprite,p=t.Button,u=t.resources,f=t.Prefab,h=t.instantiate,m=t.assetManager,N=t.SpriteFrame,g=t.Texture2D,v=t.RichText},function(t){C=t.MapController},function(t){L=t.CUtil},function(t){_=t.BaseComponent}],execute:function(){var b;a._RF.push({},"58db7uTBt5Pr5RYW2ZPCYKZ","LandInfoTipsComponent",void 0);var S=r.ccclass;r.property,t("LandInfoTipsComponent",S("LandInfoTipsComponent")(b=function(t){function a(){for(var e,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return e=t.call.apply(t,[this].concat(a))||this,n(o(e),"titleLabe",null),n(o(e),"proScrollView_contentNode",null),n(o(e),"proScrollView",null),n(o(e),"ntfsNode",null),n(o(e),"imgSprite",null),n(o(e),"closeNode",null),n(o(e),"bgNode",null),n(o(e),"tokenId",null),n(o(e),"imageUrl",null),n(o(e),"landDatas",null),n(o(e),"land_name",null),n(o(e),"LAND_NAME_LABEL",null),e}e(a,t);var r=a.prototype;return r.reset=function(){},r.start=function(){var e=this;"LandTipsNode2"!=this.node.getParent().name&&t.prototype.start.call(this),this.ntfsNode=this.node;var n=l("TestButton",this.ntfsNode);this.bgNode=l("bgNode",this.ntfsNode),this.bgNode.on(s.EventType.TOUCH_MOVE,(function(){}));var o=l("titleLabel",this.ntfsNode);this.titleLabe=o.getComponent(d),this.closeNode=l("closeButton",this.ntfsNode),this.imgSprite=l("nfts_img_Sprite",this.ntfsNode).getComponent(c),this.proScrollView=l("proScrollView",this.ntfsNode),this.proScrollView_contentNode=l("view/content",this.proScrollView),n.on(p.EventType.CLICK,(function(){u.load("Prefab/proItemNodePrefab",f,(function(t,n){t&&console.log(t);var o=h(n);e.proScrollView_contentNode.addChild(o)}))}),this),this.closeNode.on(p.EventType.CLICK,(function(){e.node&&C.resetCityInfoState()}),this),!this.land_name&&this.landDatas?L.httpPequest("https://metacitym.gamamobi.com/mcm/api/land?token="+this.tokenId,(function(t){if(t){var n=JSON.parse(t);if(n){var o=n.attributes;if(o)for(var i=0;i<o.length;i++){var a=o[i];if("land_name"==a.trait_type){e.land_name=a.value;break}}}}e.updateDatas(e.tokenId,e.imageUrl,e.landDatas)})):this.updateDatas(this.tokenId,this.imageUrl,this.landDatas)},r.updateDatas=function(t,e,n){var o=this;if(this.tokenId=t,this.imageUrl=e,this.landDatas=n,this.land_name&&this.landDatas.set("LAND NAME",this.land_name),this.ntfsNode){this.titleLabe.string="TokenID:"+t;var a=this;console.log("loadRemote imageUrl=",e),m.loadRemote(e,{xhrWithCredentials:!0},(function(t,e){if(t)console.log(t);else if(e){var n=new N,o=new g;o.image=e,n.texture=o,n&&a&&a.imgSprite&&a.imgSprite.spriteFrame&&(a.imgSprite.spriteFrame=n)}})),this.proScrollView_contentNode.removeAllChildren(),u.load("Prefab/proItemNodePrefab",f,(function(t,e){if(t)console.log(t);else{o.proScrollView_contentNode.removeAllChildren();for(var a,r=i(n);!(a=r()).done;){var s=a.value,d=s[0],c=s[1],p=h(e),u=l("itemNameLabel",p).getComponent(v),f=l("itemValueLabel",p).getComponent(v);u.string=o.setTitleText(d),f.string=o.setValueText(c),o.proScrollView_contentNode.addChild(p),"LAND NAME"==d&&(o.LAND_NAME_LABEL=f)}}}))}},r.setTitleText=function(t){return"<color=#00FFDE>"+t+"</color>"},r.setValueText=function(t){return"<color=#ffffff>"+t+"</color>"},a}(_))||b);a._RF.pop()}}}));

System.register("chunks:///_virtual/SLightComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MainGame.ts","./LandTipsNode2Component.ts","./MapController.ts"],(function(t){"use strict";var e,i,n,o,s,l,a,r,h,c,p,u,f,d,g,m,_;return{setters:[function(t){e=t.inheritsLoose,i=t.defineProperty,n=t.assertThisInitialized},function(t){o=t.cclegacy,s=t._decorator,l=t.AnimationComponent,a=t.Sprite,r=t.find,h=t.Button,c=t.resources,p=t.Prefab,u=t.instantiate,f=t.SpriteFrame,d=t.Component},function(t){g=t.MainGame},function(t){m=t.LandTipsNode2Component},function(t){_=t.MapController}],execute:function(){var k;o._RF.push({},"6be49OU6OVJD7Szbc8b5Jwc","SLightComponent",void 0);var y=s.ccclass;s.property,t("SLightComponent",y("SLightComponent")(k=function(t){function o(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(n(e),"lightTokenIds",[]),i(n(e),"lisaData",null),i(n(e),"tokenIdMapCityInfo",{}),i(n(e),"parent",null),i(n(e),"lightBgSprite",null),i(n(e),"lightBgClick",0),i(n(e),"type",3),i(n(e),"flashNode",null),i(n(e),"flashSprite",null),e}e(o,t);var s=o.prototype;return s.setLisaData=function(t){this.lisaData=t},s.startFlash=function(){this.flashNode?(console.log("flashNode startFlash"),this.flashNode.active=!0,this.flashNode.getComponent(l).play()):console.log("flashNode is null")},s.reset=function(){this.lightBgClick=0,this.setNormalStatue()},s.doClick=function(){this.lightBgClick=1,this.setClickStatue(),_.clickNodeOfSLightComponent=this},s.start=function(){var t=this;this.parent=g.find("UIParent"),this.lightBgSprite=this.node.getComponent(a),this.flashNode=r("pink_flash",this.node),this.flashSprite=this.flashNode.getComponent(a),this.node.on(h.EventType.CLICK,(function(){console.log("slight click = ",t.lightBgClick),3==t.type&&t.lisaData&&(_.getDataAndShowCityTips(t.lisaData.cityId,(function(){_.resetCityInfoState()})),t.doClick())})),this.flashNode.on(h.EventType.CLICK,(function(){console.log("flash click = ",t.lightBgClick),t.lightTokenIds.length>0&&(console.log("lightTokenIds = ",t.lightTokenIds),_.resetCityInfoState(),c.load("Prefab/LandTipsNode2",p,(function(e,i){e&&console.log(e);var n=u(i),o=n.getComponent(m);o.setData(t.lightTokenIds),o.callback=function(t){_.resetCityInfoState()},t.parent.addChild(n),_.mCityInfo=n,_.setTouchMove(n),t.doClick()})))}))},s.addTokenId=function(t,e){this.lightTokenIds.push(t),this.type=e},s.setClickStatue=function(){var t=this,e="Texture/pink_100x100v_click/spriteFrame";if(1==this.type?e="Texture/yellow_100x100v_click/spriteFrame":2==this.type?e="Texture/white_100x100v_click/spriteFrame":3==this.type&&(e="Texture/pink_100x100v_click/spriteFrame"),c.load(e,f,(function(e,i){e?console.log(e):t.lightBgSprite.spriteFrame=i})),this.node.active){var i="Texture/pink_100x100v_flash_click/spriteFrame";1==this.type?i="Texture/yellow_100x100v_flash_click/spriteFrame":2==this.type?i="Texture/white_100x100v_flash_click/spriteFrame":3==this.type&&(i="Texture/pink_100x100v_flash_click/spriteFrame"),c.load(i,f,(function(e,i){e?console.log(e):t.flashSprite.spriteFrame=i}))}},s.setNormalStatue=function(){var t=this,e="Texture/pink_100x100v_normal/spriteFrame";if(1==this.type?e="Texture/yellow_100x100v_normal/spriteFrame":2==this.type?e="Texture/white_100x100v_normal/spriteFrame":3==this.type&&(e="Texture/pink_100x100v_normal/spriteFrame"),c.load(e,f,(function(e,i){e?console.log(e):t.lightBgSprite.spriteFrame=i})),this.node.active){var i="Texture/pink_100x100v_flash/spriteFrame";1==this.type?i="Texture/yellow_100x100v_flash/spriteFrame":2==this.type?i="Texture/white_100x100v_flash/spriteFrame":3==this.type&&(i="Texture/pink_100x100v_flash/spriteFrame"),c.load(i,f,(function(e,i){e?console.log(e):t.flashSprite.spriteFrame=i}))}},o}(d))||k);o._RF.pop()}}}));

System.register("chunks:///_virtual/LisaCityInfoTipsComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MapController.ts","./CUtil.ts","./BaseComponent.ts"],(function(t){"use strict";var e,o,n,i,r,l,a,c,s,g,f,p,u,h,m,y,C,L;return{setters:[function(t){e=t.inheritsLoose,o=t.defineProperty,n=t.assertThisInitialized,i=t.createForOfIteratorHelperLoose},function(t){r=t.cclegacy,l=t._decorator,a=t.UITransform,c=t.find,s=t.Button,g=t.resources,f=t.SpriteFrame,p=t.Sprite,u=t.Prefab,h=t.instantiate,m=t.RichText},function(t){y=t.MapController},function(t){C=t.CUtil},function(t){L=t.BaseComponent}],execute:function(){var d;r._RF.push({},"6e845D3U/tNO7X1uUUPrS6/","LisaCityInfoTipsComponent",void 0);var S=l.ccclass;l.property,t("LisaCityInfoTipsComponent",S("LisaCityInfoTipsComponent")(d=function(t){function r(){for(var e,i=arguments.length,r=new Array(i),l=0;l<i;l++)r[l]=arguments[l];return e=t.call.apply(t,[this].concat(r))||this,o(n(e),"cityHomeScrollViewContent",null),o(n(e),"closeButton",null),o(n(e),"homeCityBg",null),o(n(e),"infoData",null),o(n(e),"cityLevel",0),o(n(e),"callback",null),o(n(e),"isLisa",!0),o(n(e),"orginUITransform",null),e}e(r,t);var l=r.prototype;return l.start=function(){var e=this;if(t.prototype.start.call(this),this.orginUITransform=this.node.getComponent(a),this.homeCityBg=c("homeCityBg",this.node),this.cityHomeScrollViewContent=c("cityHomeScrollView/view/content",this.node),this.closeButton=c("btn_close",this.node),this.closeButton.on(s.EventType.CLICK,(function(){e.callback&&e.callback(),e.node.removeFromParent(),e.node.destroy(),y.resetCityInfoState()})),this.isLisa){var o="Texture/LisaCityLevel_1/spriteFrame";2==this.cityLevel&&(o="Texture/LisaCityLevel_2/spriteFrame"),g.load(o,f,(function(t,o){t?console.log(t):e.homeCityBg&&(e.homeCityBg.getComponent(p).spriteFrame=o)}))}else{var n="Texture/CityLevel_1/spriteFrame";2==this.cityLevel&&(n="Texture/CityLevel_2/spriteFrame"),g.load(n,f,(function(t,o){t?console.log(t):e.homeCityBg&&(e.homeCityBg.getComponent(p).spriteFrame=o)}))}this.infoData&&g.load("Prefab/itemRichText",u,(function(t,o){if(t)console.log(t);else if(e.cityHomeScrollViewContent)for(var n,r=0,l=1,s=i(e.infoData);!(n=s()).done;){var g=n.value,f=g[0],p=g[1],u=h(o);0==r&&(r=u.getComponent(a).height,e.cityHomeScrollViewContent.getComponent(a).height=(e.infoData.size+1)*(r+10));var y=c("xxRichText",u),C="";C=l>4?e.getRichString2(f+" : ",p):e.getRichString(f+" : ",p),y.getComponent(m).string=C,e.cityHomeScrollViewContent.addChild(u),l+=1}}))},l.update=function(t){},l.updateData=function(t,e,o,n,i,r,l,a,c,s,g,f,p){console.log("updateData"),this.isLisa=t,this.cityLevel=l,this.infoData=t?new Map([[C.getLocalString("planet"),o],[C.getLocalString("city"),n],[C.getLocalString("total_land"),i],[C.getLocalString("city_level"),l+""],[C.getLocalString("land_name"),"Lisa‘s Home"],[C.getLocalString("tokenId"),a],[C.getLocalString("land_level"),c],[C.getLocalString("town"),s],[C.getLocalString("land_no"),g+""],[C.getLocalString("land_posx"),f+""],[C.getLocalString("land_posy"),p+""]]):new Map([[C.getLocalString("planet"),o],[C.getLocalString("city"),n],[C.getLocalString("total_land"),i],[C.getLocalString("city_level"),l+""]])},l.getRichString=function(t,e){return"<color=#00fff6>"+t+"</color><color=#00fff6>"+e+"</color>"},l.getRichString2=function(t,e){return"<color=#ff48da>"+t+"</color><color=#ff48da>"+e+"</color>"},r}(L))||d);r._RF.pop()}}}));

System.register("chunks:///_virtual/CityInfoTipsComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MapController.ts","./BaseComponent.ts"],(function(t){"use strict";var e,n,i,o,r,a,l,s,c,h,u,p,y;return{setters:[function(t){e=t.inheritsLoose,n=t.defineProperty,i=t.assertThisInitialized},function(t){o=t.cclegacy,r=t._decorator,a=t.find,l=t.Button,s=t.RichText,c=t.resources,h=t.SpriteFrame,u=t.Sprite},function(t){p=t.MapController},function(t){y=t.BaseComponent}],execute:function(){var d;o._RF.push({},"9fdefjZUENB74GLtfl0NkNU","CityInfoTipsComponent",void 0);var g=r.ccclass;r.property,t("CityInfoTipsComponent",g("CityInfoTipsComponent")(d=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(i(e),"landBg",null),n(i(e),"planetText",null),n(i(e),"cityText",null),n(i(e),"totalLandText",null),n(i(e),"cityGradeText",null),n(i(e),"closeButton",null),n(i(e),"cityBgNode",null),n(i(e),"mParent",null),n(i(e),"url",null),n(i(e),"planet",null),n(i(e),"cityName",null),n(i(e),"totalLand",null),n(i(e),"cityGrade",null),n(i(e),"cityLevel",0),e}e(o,t);var r=o.prototype;return r.start=function(){var e=this;t.prototype.start.call(this),this.mParent=this.node,this.landBg=a("land_bg",this.mParent),this.planetText=a("city_info/PlanetRichText",this.mParent),this.cityText=a("city_info/CityRichText",this.mParent),this.totalLandText=a("city_info/TotalLandRichText",this.mParent),this.cityGradeText=a("city_info/CityGradeRichText",this.mParent),this.closeButton=a("btn_close",this.mParent),this.cityBgNode=a("land_bg/cityBg",this.mParent),this.closeButton.on(l.EventType.CLICK,(function(){e.mParent.removeFromParent(),e.mParent.destroy(),p.resetCityInfoState()})),console.log("CityInfoTipsComponent start"),this.planetText.getComponent(s).string=this.getRichString("Planet: ",this.planet),this.cityText.getComponent(s).string=this.getRichString("City: ",this.cityName),this.totalLandText.getComponent(s).string=this.getRichString("TotalLand: ",this.totalLand),this.cityGradeText.getComponent(s).string=this.getRichString("City Grade: ",this.cityGrade),2==this.cityLevel&&c.load("Texture/CityLevel_2/spriteFrame",h,(function(t,n){t?console.log(t):e.cityBgNode.getComponent(u).spriteFrame=n}))},r.updateData=function(t,e,n,i,o,r){console.log("updateData"),this.url=t,this.planet=e,this.cityName=n,this.totalLand=i,this.cityGrade=o,this.cityLevel=r},r.getRichString=function(t,e){return"<color=#00f1e8>"+t+"</color><color=#f0b432>"+e+"</color>"},o}(y))||d);o._RF.pop()}}}));

System.register("chunks:///_virtual/BaseComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./CUtil.ts"],(function(e){"use strict";var t,c,n,s,o,i,a,r;return{setters:[function(e){t=e.inheritsLoose,c=e.defineProperty,n=e.assertThisInitialized},function(e){s=e.cclegacy,o=e._decorator,i=e.Vec3,a=e.Component},function(e){r=e.CUtil}],execute:function(){var l;s._RF.push({},"ac51eX5j+NKjKI5FKfQ0Ixa","BaseComponent",void 0);var u=o.ccclass;o.property,e("BaseComponent",u("BaseComponent")(l=function(e){function s(){for(var t,s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o))||this,c(n(t),"scaleVec3",void 0),t}return t(s,e),s.prototype.start=function(){if(this.scaleVec3=r.getScaleRatio(),this.scaleVec3){var e=this.node.getScale(),t=new i(this.scaleVec3.x*e.x,this.scaleVec3.y*e.y,this.scaleVec3.z*e.z);this.node.setScale(t)}},s}(a))||l);s._RF.pop()}}}));

System.register("chunks:///_virtual/LanguageComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MainGame.ts"],(function(e){"use strict";var n,a,t,o,i,g,l,u,s;return{setters:[function(e){n=e.inheritsLoose,a=e.defineProperty,t=e.assertThisInitialized},function(e){o=e.cclegacy,i=e._decorator,g=e.find,l=e.Button,u=e.Component},function(e){s=e.MainGame}],execute:function(){var c;o._RF.push({},"b82b4M4t+9He5NGuP9cXEIj","LanguageComponent",void 0);var d=i.ccclass;i.property,e("LanguageComponent",d("LanguageComponent")(c=function(e){function o(){for(var n,o=arguments.length,i=new Array(o),g=0;g<o;g++)i[g]=arguments[g];return n=e.call.apply(e,[this].concat(i))||this,a(t(n),"changeLanguageNode",null),a(t(n),"languageContentNode",null),a(t(n),"languageBgNode",null),a(t(n),"zhLabelNode",null),a(t(n),"enLabelNode",null),a(t(n),"krLabelNode",null),a(t(n),"jpLabelNode",null),a(t(n),"taiLabelNode",null),n}n(o,e);var i=o.prototype;return i.start=function(){var e=this;this.changeLanguageNode=g("language_select",this.node),this.languageBgNode=g("language_bg",this.node),this.languageContentNode=g("language_bg/languageScrollView/view/content",this.node),this.zhLabelNode=g("zhLabel",this.languageContentNode),this.enLabelNode=g("enLabel",this.languageContentNode),this.krLabelNode=g("krLabel",this.languageContentNode),this.jpLabelNode=g("jpLabel",this.languageContentNode),this.taiLabelNode=g("taiLabel",this.languageContentNode),this.changeLanguageNode.on(l.EventType.CLICK,(function(){e.languageBgNode.active?e.languageBgNode.active=!1:e.languageBgNode.active=!0})),this.zhLabelNode.on(l.EventType.CLICK,(function(){e.languageBgNode.active=!1,e.switchTo("zh_TW")})),this.enLabelNode.on(l.EventType.CLICK,(function(){e.languageBgNode.active=!1,e.switchTo("en")})),this.krLabelNode.on(l.EventType.CLICK,(function(){e.languageBgNode.active=!1,e.switchTo("kr")})),this.taiLabelNode.on(l.EventType.CLICK,(function(){e.languageBgNode.active=!1,e.switchTo("th")})),this.jpLabelNode.on(l.EventType.CLICK,(function(){e.languageBgNode.active=!1,e.switchTo("jp")}))},i.switchTo=function(e){var n="https://metacitym.com/map/?language="+e;s.isLogin&&(n=n+"&address="+s.address),location.href=n},o}(u))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/TokenIdButtonComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MainGame.ts","./LandTipsNode2Component.ts","./SLightComponent.ts","./MapController.ts"],(function(t){"use strict";var n,o,e,i,a,r,s,c,l,u,p,d,f,h,C;return{setters:[function(t){n=t.inheritsLoose,o=t.defineProperty,e=t.assertThisInitialized},function(t){i=t.cclegacy,a=t._decorator,r=t.find,s=t.Button,c=t.resources,l=t.Prefab,u=t.instantiate,p=t.Component},function(t){d=t.MainGame},function(t){f=t.LandTipsNode2Component},function(t){h=t.SLightComponent},function(t){C=t.MapController}],execute:function(){var g;i._RF.push({},"e341c7WxlRBm6lvXLdHjCUg","TokenIdButtonComponent",void 0);var m=a.ccclass;a.property,t("TokenIdButtonComponent",m("TokenIdButtonComponent")(g=function(t){function i(){for(var n,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return n=t.call.apply(t,[this].concat(a))||this,o(e(n),"bgNode",null),o(e(n),"parent",null),n}n(i,t);var a=i.prototype;return a.reset=function(){this.bgNode.active=!1},a.start=function(){this.parent=d.find("UIParent"),this.bgNode=r("white_bg",this.node),this.bgNode.active=!1},a.btnClickCallback=function(t,n){var o=this;t.target.getComponent(s);console.log(n);var e=parseInt(n);C.resetCityInfoState();var i=[e],a=C.lightPosWithTokenId[e];a&&c.load("Prefab/LandTipsNode2",l,(function(t,n){t&&console.log(t);var e=u(n),r=e.getComponent(f);r.setData(i),r.callback=function(t){C.resetCityInfoState()},o.parent.addChild(e),C.mCityInfo=e,C.setTouchMove(e);var s=a.x+"_"+a.y,c=C.lightPosWithLightNode[s];c&&c.getComponent(h).doClick()}))},i}(p))||g);i._RF.pop()}}}));

System.register("chunks:///_virtual/MainGame.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./UIController.ts","./MapController.ts","./CUtil.ts"],(function(n){"use strict";var a,e,t,r,i,s,u,l,o;return{setters:[function(n){a=n.defineProperty,e=n.inheritsLoose},function(n){t=n.cclegacy,r=n._decorator,i=n.find,s=n.Component},function(n){u=n.UIController},function(n){l=n.MapController},function(n){o=n.CUtil}],execute:function(){var c,d,f;t._RF.push({},"fc1783xF95ARYakZeB0C/v9","MainGame",void 0);var m=r.ccclass;n("MainGame",m("MainGame")((f=d=function(n){function a(){return n.apply(this,arguments)||this}e(a,n),a.find=function(n){return i(n,a.mainCanvas)},a.isLogin=function(){return!(!a.address||""==a.address)};var t=a.prototype;return t.start=function(){a.mainCanvas=i("Canvas"),a.mainCamera=i("Camera",a.mainCanvas),a.address=o.getQueryVariable("address"),a.language=o.getQueryVariable("language"),a.language||(a.language="en"),l.init(),u.init()},t.update=function(n){a.deltaTime=n},a}(s),a(d,"mainCamera",null),a(d,"mainCanvas",null),a(d,"deltaTime",0),a(d,"address",null),a(d,"language",null),c=f))||c);t._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./UIController.ts","./MainGame.ts","./LandInfoTipsComponent.ts","./LandTipsNode2Component.ts","./SLightComponent.ts","./LisaCityInfoTipsComponent.ts","./MapController.ts","./CUtil.ts","./BaseComponent.ts","./UIParentComponent.ts","./SPageViewComponent.ts","./TokenIdModel.ts","./LoginInfoComponent.ts","./CityInfoTipsComponent.ts","./LanguageComponent.ts","./TokenIdButtonComponent.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});
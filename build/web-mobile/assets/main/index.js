System.register("chunks:///_virtual/UIParentComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./BaseComponent.ts"],(function(t){"use strict";var n,e,o,r;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator},function(t){r=t.BaseComponent}],execute:function(){var s;e._RF.push({},"021ddaLy3FFoKt6RJ0gmJVK","UIParentComponent",void 0);var c=o.ccclass;o.property,t("UIParentComponent",c("UIParentComponent")(s=function(t){function e(){return t.apply(this,arguments)||this}return n(e,t),e.prototype.start=function(){},e}(r))||s);e._RF.pop()}}}));

System.register("chunks:///_virtual/MapController.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MainGame.ts","./LandInfoTipsComponent.ts","./SLightComponent.ts","./LisaCityInfoTipsComponent.ts","./CUtil.ts"],(function(t){"use strict";var o,e,i,n,s,a,l,h,r,c,g,d,p,u,m,f,T,w,y;return{setters:[function(t){o=t.defineProperty},function(t){e=t.cclegacy,i=t.find,n=t.TiledMap,s=t.resources,a=t.view,l=t.Input,h=t.Vec2,r=t.Prefab,c=t.instantiate,g=t.Vec3,d=t.UITransform,p=t.clamp,u=t.Graphics},function(t){m=t.MainGame},function(t){f=t.LandInfoTipsComponent},function(t){T=t.SLightComponent},function(t){w=t.LisaCityInfoTipsComponent},function(t){y=t.CUtil}],execute:function(){e._RF.push({},"07a9aKaoKBJIIFuQKuYKGUx","MapController",void 0);var v=t("MapController",function(){function t(){}return t.init=function(){var o=this;this.mapInput=m.find("MapInput"),this.mapGroup=i("MapGroup",this.mapInput),this.uIParent=m.find("UIParent"),this.basePosYRange=this.oneMapHeight*this.minScale,this.mapTiled=i("Map1/Tiled",this.mapGroup).getComponent(n);var e=this.mapInput;s.load("Json/language/"+m.language,(function(t,e){t?console.log(t):o.languageDic=e.json})),a.setResizeCallback((function(){console.log("setResizeCallback"),o.move(.1,.1)})),s.load("Json/MapData/map",(function(e,i){if(e)console.log(e);else{for(var n=i.json.townlist,s=0;s<n.length;s++){var a=n[s],l="x_"+a.posx+"_y_"+a.posy,h=[];o.worldTowns[l]&&(h=o.worldTowns[l]),h[h.length]=a,o.worldTowns[l]=h,o.worldTownsWithTownId[a.id+""]=a,o.allWorldTownId.push(a.id+"");var r=[];o.belongTowns[a.belong]&&(r=o.belongTowns[a.belong]),r[r.length]=a,o.belongTowns[a.belong]=r}o.loadDataFinish=o.loadDataFinish+1,t.setLisaCityBg(),console.log("this.worldTowns =",o.worldTowns),console.log("this.belongTowns =",o.belongTowns)}})),s.load("Json/MapData/cityname",(function(t,e){if(console.log("err, data = ",t,e),t)console.log(t);else for(var i=e.json.list,n=0;n<i.length;n++){var s=i[n];o.cityNameMap[s.id]=s.name}})),s.load("Json/MapData/city",(function(e,i){if(e)console.log(e);else{var n=i.json.citylist;if(n){for(var s=0;s<n.length;s++){var a=n[s];o.cityInfo[a.id]=a}o.loadDataFinish=o.loadDataFinish+1,t.setLisaCityBg()}}})),s.load("Json/MapData/landpos",(function(t,e){t?console.log(t):(o.saledLandData=e.json,s.load("Json/MapData/webmap_buchang_5016",(function(t,e){if(t)console.log(t);else{var i=e.json;if(i)for(var n in i)o.saledLandData[n]||(o.saledLandData[n]=i[n])}})))})),s.load("Json/lisaHomeData/lisaData",(function(e,i){if(e)console.log(e);else{for(var n=i.json,s=0;s<n.length;s++){var a=n[s];o.lisaData[a.cityId]=a}o.loadDataFinish=o.loadDataFinish+1,t.setLisaCityBg()}})),e.on(l.EventType.TOUCH_START,(function(t){var e=t.getAllTouches();2==e.length&&(o.lastTouchPos1&&o.lastTouchPos2||(o.lastTouchPos1=new h(0,0),o.lastTouchPos2=new h(0,0)),o.lastTouchPos1.x=e[0].getLocationX(),o.lastTouchPos1.y=e[0].getLocationY(),o.lastTouchPos2.x=e[1].getLocationX(),o.lastTouchPos2.y=e[1].getLocationY())})),e.on(l.EventType.TOUCH_MOVE,(function(t){var e=t.getAllTouches(),i=e.length;if(1==i)o.move(t.getDeltaX(),t.getDeltaY());else if(2==i){var n=e[0].getLocationX(),s=e[0].getLocationY(),a=e[1].getLocationX(),l=e[1].getLocationY(),h=(Math.sqrt(Math.pow(n-a,2)+Math.pow(s-l,2))-Math.sqrt(Math.pow(o.lastTouchPos1.x-o.lastTouchPos2.x,2)+Math.pow(o.lastTouchPos1.y-o.lastTouchPos2.y,2)))/(screen.height/o.touchBaseHeight)*o.touchZoomRate;o.scale(h,(e[0].getUILocationX()+e[1].getUILocationX())/2,(e[0].getUILocationY()+e[1].getUILocationY())/2),o.lastTouchPos1.x=n,o.lastTouchPos1.y=s,o.lastTouchPos2.x=a,o.lastTouchPos2.y=l}(Math.abs(t.getDeltaX())>=1||Math.abs(t.getDeltaY())>=1)&&(o.isDrag=!0)})),e.on(l.EventType.MOUSE_WHEEL,(function(t){o.scale(o.mouseWheelRate*t.getScrollY(),t.getUILocationX(),t.getUILocationY())})),e.on(l.EventType.TOUCH_END,(function(t){if(!o.isDrag){var e=t.getUILocation(),i=o.getMapTownPos(e.x,e.y);o.transferToTilePos(i),console.log("城镇左上角坐标:   ",t.getAllTouches().length,i);var n="x_"+i.x+"_y_"+i.y,s=o.worldTowns[n];if(!s)return void console.log("当前点击的不是城镇图标",i);o.getDataAndShowCityTipsFromClick(s)}o.isDrag=!1}))},t.setLisaCityBg=function(){var t=this;if(3==this.loadDataFinish){for(var o in this.lisaData)Object.prototype.hasOwnProperty.call(this.lisaData,o)&&function(){var e=t.lisaData[o],i=t.belongTowns[e.cityId][0],n=t.cityInfo[e.cityId],a=t.getCityFirstTownPos(i.id,n);if(a){var l=n.level,h="Prefab/slight_pink_"+l;s.load(h,r,(function(o,i){if(o)console.log(o);else for(var n=-1;n<=1;n++){var s=a.x+n*t.oneMapWidth,h=a.y,r=c(i);1==l?(t.mapGroup.addChild(r),r.setPosition(s+38,h-38)):2==l&&(t.mapGroup.addChild(r),r.setPosition(s+19,h-19)),r.getComponent(T).setLisaData(e),t.lisaHomeNodes[s+"_"+h]=r}}))}}();console.log("set lisa home bg finish")}},t.getPosYRange=function(){this.getPosYRangeV2||(this.getPosYRangeV2=new h(0,0));var t=(this.mapGroup.scale.x*this.oneMapHeight-this.basePosYRange)/2;return t<=0?(this.getPosYRangeV2.x=0,this.getPosYRangeV2.y=0):(this.getPosYRangeV2.x=t,this.getPosYRangeV2.y=-t),this.getPosYRangeV2},t.getMapTownPos=function(t,o){this.getMapTownPosInV3&&this.getMapTownPosOutV3||(this.getMapTownPosInV3=new g(0,0,0),this.getMapTownPosOutV3=new g(0,0,0)),this.getMapTownPosInV3.x=t,this.getMapTownPosInV3.y=o,this.mapGroup.getComponent(d).convertToNodeSpaceAR(this.getMapTownPosInV3,this.getMapTownPosOutV3);var e=(this.getMapTownPosOutV3.x+this.halfOneMapWidth)%this.oneMapWidth,i=(this.getMapTownPosOutV3.y+this.halfOneMapHeight)%this.oneMapHeight;return e<0&&(e+=this.oneMapWidth),i<0&&(i+=this.oneMapHeight),i=this.oneMapHeight-i,this.getMapTownPosOutV3.x=e,this.getMapTownPosOutV3.y=i,this.getMapTownPosOutV3},t.getPosXRange=function(){this.getPosXRangeV2||(this.getPosXRangeV2=new h(0,0));var t=this.mapGroup.scale.x*this.oneMapWidth-100;return this.getPosXRangeV2.x=t,this.getPosXRangeV2.y=-t,this.getPosXRangeV2},t.move=function(t,o){console.log("deltaX,deltaY",t,o);var e=this.mapGroup.position.x+t,i=this.mapGroup.position.y+o,n=this.getPosYRange();i=p(i,n.y,n.x);var s=this.getPosXRange();e>s.x?e-=s.x:e<s.y&&(e-=s.y),this.mapGroup.setPosition(e,i,0),this.resetDrawGraphicsLine()},t.scale=function(t,o,e){this.scaleInV3&&this.scaleOutV3||(this.scaleInV3=new g(0,0,0),this.scaleOutV3=new g(0,0,0)),this.scaleInV3.x=o,this.scaleInV3.y=e,this.mapGroup.getComponent(d).convertToNodeSpaceAR(this.scaleInV3,this.scaleOutV3);var i=this.mapGroup.scale.x;t=p(t+=i,this.minScale,this.maxScale),this.mapGroup.setScale(t,t,t);var n=this.mapGroup.scale.x-i,s=0,a=0;this.scaleOutV3.x<0?s=1:this.scaleOutV3.x>0&&(s=-1),this.scaleOutV3.y<0?a=1:this.scaleOutV3.y>0&&(a=-1),this.move(s*n*this.halfOneMapWidth*Math.abs(this.scaleOutV3.x/this.halfOneMapWidth),a*n*this.halfOneMapHeight*Math.abs(this.scaleOutV3.y/this.halfOneMapHeight))},t.transferToTilePos=function(t){var o=this.mapTiled.getTileSize();t.x=Math.floor(t.x/o.x),t.y=Math.floor(t.y/o.y)},t.getDataAndShowCityTipsFromClick=function(t){var o=this.cityInfo[t[0].belong];t[0].id;console.log("city = ",o,t),this.getDataAndShowCityTips(o.id,(function(){}))},t.getDataAndShowCityTips=function(o,e){var i=this,n=this.cityInfo[o];if(n){var a="Titan",l="",h=600,g="1st class city",d="",p=this.belongTowns[o][0].id;if(n){l=n.id,1==n.level?g="1st class city":(g="2nd class city",h=300),(d=this.cityNameMap[l])||(d=l+" City"),t.resetCityInfoState();var u=n.level,m=t.getCityFirstTownPos(p,n),f=this.lisaData[l+""];f?t.showLisaCityInfo(!0,a,d,h,g,n,f,u,m,e):s.load("Prefab/LisaCityTips",r,(function(o,s){if(o)console.log(o);else{i.mAlertView=c(s);var l=i.mAlertView.getComponent(w);l.updateData(!1,"",a,d,h+"",g,n.level,"","","","","",""),l.callback=e,i.uIParent.addChild(i.mAlertView),i.setTouchMove(i.mAlertView),t.setCityBlockBg(u,m)}}))}}else console.log("not find city cityId=",o)},t.setCityBlockBg=function(t,o){var e=this;1==t?s.load("Prefab/mapYellowClickBg",r,(function(t,i){t?console.log(t):(e.mClickCityBgNode=c(i),e.mapGroup.addChild(e.mClickCityBgNode),e.mClickCityBgNode.setPosition(o.x+38,o.y-38),e.resetDrawGraphicsLine())})):s.load("Prefab/mapWhiteClickBg",r,(function(t,i){t?console.log(t):(e.mClickCityBgNode=c(i),e.mapGroup.addChild(e.mClickCityBgNode),e.mClickCityBgNode.setPosition(o.x+19,o.y-19),e.resetDrawGraphicsLine())}))},t.showLisaCityInfo=function(t,o,e,i,n,a,l,h,g,d){var p=this;s.load("Prefab/LisaCityTips",r,(function(t,s){if(t)console.log(t);else{p.mAlertView=c(s);var h=p.mAlertView.getComponent(w);h.updateData(!0,"",o,e,i+"",n,a.level,l.tokenID,l.landLevel,l.townName,l.landNo,l.landPosx,l.landPosy),h.callback=d,p.uIParent.addChild(p.mAlertView),p.setTouchMove(p.mAlertView)}}))},t.resetCityInfoState=function(){this.mGraphics&&(this.mGraphics.clear(),this.mGraphics=null),this.clickNodeOfSLightComponent&&(this.clickNodeOfSLightComponent.reset(),this.clickNodeOfSLightComponent=null),this.mLandInfoTipsComponent&&(this.mLandInfoTipsComponent.reset(),this.mLandInfoTipsComponent=null),this.mTokenIdButtonComponent&&(this.mTokenIdButtonComponent.reset(),this.mTokenIdButtonComponent=null),this.mAlertView&&(this.mAlertView.removeFromParent(),this.mAlertView.destroy(),this.mAlertView=null),this.mClickCityBgNode&&(this.mClickCityBgNode.removeFromParent(),this.mClickCityBgNode.destroy(),this.mClickCityBgNode=null)},t.getDataAndShowLandTips=function(t,o,e){var i=this,n=this.saledLandData[t+""];if(n){var a=n.townid,l=this.townLands[a];if(l){var h=l["x_"+n.landx+"_y_"+n.landy];this.showLandTips(t,h,o,e)}else s.load("Json/Land/"+a,(function(s,l){if(s)console.log("err = ",s);else{for(var h={},r=l.json,c=0;c<r.length;c++){var g=r[c];h["x_"+g.posx+"_y_"+g.posy]=g}i.townLands[a]=h;var d="x_"+n.landx+"_y_"+n.landy,p=i.townLands[a][d];i.showLandTips(t,p,o,e)}}))}else console.log("not found the saledLandData by tokenId: ",t)},t.showLandTips=function(t,o,e,i){var n=this;if(o){var a=o.townid,l=o.posx,h=o.posy,g=(o.cityid,this.cityNameMap[o.cityid]);g&&g+" , "+o.townid+"Town",g||(g=o.cityid+" City");var d="2",p=this.cityInfo[o.cityid];if(e)this.createLightNode(t,a,p,i);else{p&&(d=1==p.level?"1":"2");var u="B";1==o.level?u="S":2==o.level&&(u="A");var m=o.id.toString(16),w=(m=parseInt(m.substring(m.length-4),16))%150;0==w&&(w=150);var v="X:"+o.posx+"/Y:"+o.posy,C="https://static-download2.metacitym.com"+o.imageurl;console.log("hello land:townId,cityid,cityName,cityLevel,landId,landLevel,landPos,landUrl=",a,o.cityid,g,d,w,u,v,C);var P=new Map([[y.getLocalString("planet"),"Titan"],[y.getLocalString("city_level"),d],[y.getLocalString("land_level"),u],[y.getLocalString("city"),g],[y.getLocalString("town"),a+"Town"],[y.getLocalString("land_no"),w+""],[y.getLocalString("land_posx"),l+""],[y.getLocalString("land_posy"),h+""],[y.getLocalString("land_size"),"40*30"]]);if(i)return void i(t,C,P);var I=this.lightPosWithTokenId[t];if(I){s.load("Prefab/nfts_bg",r,(function(o,e){o?console.log(o):(n.mAlertView=c(e),n.mLandInfoTipsComponent=n.mAlertView.getComponent(f),n.mLandInfoTipsComponent.updateDatas(t+"",C,P),n.uIParent.addChild(n.mAlertView),n.setTouchMove(n.mAlertView))}));var L=I.x+"_"+I.y,M=this.lightPosWithLightNode[L];M&&M.getComponent(T).doClick()}}}else console.log("not found the town land")},t.createLightNode=function(o,e,i,n){var a=this;if(this.worldTownsWithTownId[e]){var l=i.level,h=t.getCityFirstTownPos(e,i);this.lightPosWithTokenId[o]=h;var g=this.lisaData[i.id+""];if(this.lightPosWithLightNode[h.x+"_"+h.y]){for(var d=-1;d<=1;d++){var p=h.x+d*this.oneMapWidth,u=h.y,m=this.lightPosWithLightNode[p+"_"+u];g?m.getComponent(T).addTokenId(o,3):m.getComponent(T).addTokenId(o,l)}return void n()}if(g){console.log("start lisa flash tokenId="+o);for(var f=-1;f<=1;f++){var w=h.x+f*this.oneMapWidth,y=h.y,v=this.lisaHomeNodes[w+"_"+y];v.getComponent(T).startFlash(),v.getComponent(T).addTokenId(o,3),this.lightPosWithLightNode[w+"_"+y]=v}return void n()}var C="Prefab/slight"+l;s.load(C,r,(function(t,e){if(t)console.log(t);else{for(var i=-1;i<=1;i++){var s=h.x+i*a.oneMapWidth,r=h.y,g=c(e);a.mapGroup.addChild(g),1==l?(g.setPosition(s+38,r-38),g.getComponent(T).addTokenId(o,l)):(g.setPosition(s+19,r-19),g.getComponent(T).addTokenId(o,l)),a.lightPosWithLightNode[s+"_"+r]=g}n()}}))}else console.log("找不到townInfo townId="+e),n()},t.getCityFirstTownPos=function(t,o){if(null==t||null==o)return null;var e=this.worldTownsWithTownId[t],i=e.posx,n=e.posy;o.level;if(1==o.level){var s=this.belongTowns[e.belong][0];s&&(i=s.posx,n=s.posy)}return this.getUIPosByTownPos(i,n)},t.testCreateAllLight=function(){this.worldTownsWithTownId},t.getUIPosByTownPos=function(t,o){var e=new g(0,0,0),i=this.mapTiled.getTileSize(),n=i.x*t,s=i.y*o;return s=this.oneMapHeight-s,e.x=n-this.halfOneMapWidth,e.y=s-this.halfOneMapHeight,e},t.canMove=function(){return!(this.mAlertView||!this.mapCanMove)},t.canScale=function(){return!(this.mAlertView||!this.mapCanScale)},t.setTouchMove=function(t){var o=this;t&&(t.on(l.EventType.TOUCH_MOVE,(function(e){1==e.getAllTouches().length&&o.alertViewMove(t,e.getDeltaX(),e.getDeltaY())})),this.resetDrawGraphicsLine())},t.alertViewMove=function(t,o,e){console.log("deltaX,deltaY",o,e);var i=1;a.getScaleY()>1&&(i=a.getScaleY());var n=t.position.x+o/i,s=t.position.y+e/i;t.setPosition(n,s,0),this.resetDrawGraphicsLine()},t.resetDrawGraphicsLine=function(){if(this.mAlertView&&(this.mClickCityBgNode||this.clickNodeOfSLightComponent)&&(!this.mGraphics&&this.mAlertView.getChildByName("lineNode")&&(this.mGraphics=this.mAlertView.getChildByName("lineNode").getComponent(u)),this.mGraphics)){var t=this.mClickCityBgNode;if(!t&&this.clickNodeOfSLightComponent&&(t=this.clickNodeOfSLightComponent.node),!t)return;this.lightNodeWorldPos||(this.lightNodeWorldPos=new g(0,0,0)),this.lightNodeToAlertPos||(this.lightNodeToAlertPos=new g(0,0,0)),t.getWorldPosition(this.lightNodeWorldPos),this.mAlertView&&(this.mAlertView.getComponent(d).convertToNodeSpaceAR(this.lightNodeWorldPos,this.lightNodeToAlertPos),this.mGraphics.clear(),this.mGraphics.moveTo(0,0),this.mGraphics.lineTo(this.lightNodeToAlertPos.x,this.lightNodeToAlertPos.y),this.mGraphics.close(),this.mGraphics.stroke(),this.mGraphics.fill())}},t}());o(v,"mapInput",null),o(v,"mapGroup",null),o(v,"uIParent",null),o(v,"mapTiled",null),o(v,"oneMapWidth",6498),o(v,"oneMapHeight",3724),o(v,"halfOneMapWidth",3249),o(v,"halfOneMapHeight",1862),o(v,"mapCount",3),o(v,"minScale",.2),o(v,"maxScale",1.8),o(v,"basePosYRange",0),o(v,"mouseWheelRate",1e-4),o(v,"touchZoomRate",.0012),o(v,"touchBaseHeight",1080),o(v,"touchMoveRate",.5),o(v,"lastTouchPos1",null),o(v,"lastTouchPos2",null),o(v,"isDrag",!1),o(v,"worldTowns",{}),o(v,"worldTownsWithTownId",{}),o(v,"allWorldTownId",[]),o(v,"belongTowns",{}),o(v,"cityInfo",{}),o(v,"cityNameMap",{}),o(v,"saledLandData",{}),o(v,"townLands",{}),o(v,"lisaData",{}),o(v,"lightPosNode",{}),o(v,"lightPosWithTokenId",{}),o(v,"lightPosWithLightNode",{}),o(v,"mAlertView",null),o(v,"mClickCityBgNode",null),o(v,"loadDataFinish",0),o(v,"mapCanMove",!0),o(v,"mapCanScale",!0),o(v,"lisaHomeNodes",{}),o(v,"languageDic",{}),o(v,"clickNodeOfSLightComponent",null),o(v,"mLandInfoTipsComponent",null),o(v,"mTokenIdButtonComponent",null),o(v,"getPosYRangeV2",null),o(v,"getMapTownPosInV3",null),o(v,"getMapTownPosOutV3",null),o(v,"getPosXRangeV2",null),o(v,"scaleInV3",null),o(v,"scaleOutV3",null),o(v,"mGraphics",null),o(v,"lightNodeWorldPos",null),o(v,"lightNodeToAlertPos",null),e._RF.pop()}}}));

System.register("chunks:///_virtual/SPageViewComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(e){"use strict";var t,n,a,i,o,s,r,d;return{setters:[function(e){t=e.inheritsLoose,n=e.defineProperty,a=e.assertThisInitialized},function(e){i=e.cclegacy,o=e._decorator,s=e.find,r=e.PageView,d=e.Component}],execute:function(){var g;i._RF.push({},"14d99EhWsRJfLc7wJbEuXYv","SPageViewComponent",void 0);var h=o.ccclass;o.property,e("SPageViewComponent",h("SPageViewComponent")(g=function(e){function i(){for(var t,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return t=e.call.apply(e,[this].concat(o))||this,n(a(t),"mPageView",null),n(a(t),"lightTokenIds",[]),n(a(t),"tokenIdMapLandUrl",{}),n(a(t),"tokenIdMapCityInfo",{}),n(a(t),"pageNodes",[]),n(a(t),"xxCurrentPageIndex",0),n(a(t),"dataIndex",4),n(a(t),"handling",0),t}t(i,e);var o=i.prototype;return o.start=function(){s("view/content",this.node);this.mPageView=this.node.getComponent(r),this.pageNodes=this.mPageView.getPages()},o.update=function(e){this.handlePage()},o.callback=function(e,t){console.log(t)},o.handlePage=function(){var e=this.mPageView.getCurrentPageIndex();if(console.log("currentPageIndex=",e),e>this.xxCurrentPageIndex&&(this.dataIndex=this.dataIndex+1),e<this.xxCurrentPageIndex&&(this.dataIndex=this.dataIndex-1),1==e&&0==this.handling){this.handling=1;var t=this.pageNodes.shift();this.mPageView.removePage(t),this.mPageView.addPage(t),this.pageNodes.push(t),this.mPageView.setCurrentPageIndex(0),this.handling=0}},o.setData=function(e,t,n){this.lightTokenIds=e,this.tokenIdMapLandUrl=t,this.tokenIdMapCityInfo=n},i}(d))||g);i._RF.pop()}}}));

System.register("chunks:///_virtual/TokenIdModel.ts",["./_rollupPluginModLoBabelHelpers.js","cc"],(function(t){"use strict";var e,n,o;return{setters:[function(t){e=t.defineProperty},function(t){n=t.cclegacy,o=t._decorator}],execute:function(){var c;n._RF.push({},"1b7cd1lQ15DPZdl21IAA+kY","TokenIdModel",void 0);var s=o.ccclass;o.property,t("TokenIdModel",s("TokenIdModel")(c=function(){e(this,"ownerNfts",[]),e(this,"pageKey",""),e(this,"totalCount",0),e(this,"blockHash","")})||c),t("OwnerNft",(function(){e(this,"contract",null),e(this,"id",null),e(this,"balance","")})),t("Contract",(function(){e(this,"address","")})),t("Id",(function(){e(this,"tokenId","")}));n._RF.pop()}}}));

System.register("chunks:///_virtual/UIController.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MainGame.ts"],(function(e){"use strict";var t,n,r,a,i,o,c;return{setters:[function(e){t=e.defineProperty},function(e){n=e.cclegacy,r=e._decorator,a=e.resources,i=e.Prefab,o=e.instantiate},function(e){c=e.MainGame}],execute:function(){var l,s,u;n._RF.push({},"3b5f6XUzCBF87UiVZLCmNK4","UIController",void 0);var p=r.ccclass;r.property,e("UIController",p("UIController")((u=s=function(){function e(){}return e.init=function(){e.parent=c.find("UIParent")},e.create=function(e,t,n){var r=this,c=null;this.map.has(e)?(c=this.map.get(e),this.map.delete(e),n(c),c.active=!0):a.load("Prefab/"+e,i,(function(e,a){e?console.log(e):(c=o(a),t&&r.parent.addChild(c),n(c))}))},e.recycle=function(e){e.active=!1,this.map.set(e.name,e)},e}(),t(s,"parent",null),t(s,"map",new Map),l=u))||l);n._RF.pop()}}}));

System.register("chunks:///_virtual/LoginInfoComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MainGame.ts","./MapController.ts","./CUtil.ts","./BaseComponent.ts"],(function(t){"use strict";var e,n,o,i,a,s,l,r,c,d,h,u,g,f,p,I,m,k;return{setters:[function(t){e=t.inheritsLoose,n=t.defineProperty,o=t.assertThisInitialized,i=t.asyncToGenerator},function(t){a=t.cclegacy,s=t._decorator,l=t.find,r=t.Button,c=t.sys,d=t.resources,h=t.Prefab,u=t.instantiate,g=t.UITransform,f=t.Label},function(t){p=t.MainGame},function(t){I=t.MapController},function(t){m=t.CUtil},function(t){k=t.BaseComponent}],execute:function(){var v;a._RF.push({},"3d843/pR55AlqBfle6c61rL","LoginInfoComponent",void 0);var L=s.ccclass;s.property,t("LoginInfoComponent",L("LoginInfoComponent")(v=function(t){function a(){for(var e,a=arguments.length,s=new Array(a),l=0;l<a;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,n(o(e),"tokenIdScrollView",null),n(o(e),"tokenIdScrollViewContentNode",null),n(o(e),"loginTokenInfoNode",null),n(o(e),"tipsLabelNode",null),n(o(e),"loadingLabelNode",null),n(o(e),"mParent",null),n(o(e),"buylandBtn",null),n(o(e),"ntfStartBtn",null),n(o(e),"loginButton",null),n(o(e),"logoutButton",null),n(o(e),"tokenIds",[]),n(o(e),"sleep",function(){var t=i(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){setTimeout(t,e)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),n(o(e),"orginWidget",null),n(o(e),"lightIndex",0),e}e(a,t);var s=a.prototype;return s.start=function(){this.initNode()},s.initNode=function(){var t=this;this.mParent=p.find("UIParent"),this.loginTokenInfoNode=this.node,this.buylandBtn=l("buyland",this.loginTokenInfoNode),this.ntfStartBtn=l("nft_start",this.loginTokenInfoNode),this.loginButton=l("loginButton",this.loginTokenInfoNode),this.logoutButton=l("logoutButton",this.loginTokenInfoNode),this.tokenIdScrollView=l("tokenScrollView",this.loginTokenInfoNode),this.tokenIdScrollViewContentNode=l("view/content",this.tokenIdScrollView),this.loadingLabelNode=l("loadingLabel",this.tokenIdScrollView),this.loadingLabelNode.active=!1,this.tipsLabelNode=l("noDataTips",this.tokenIdScrollView),this.tipsLabelNode.active=!1,this.tipsLabelNode.on(r.EventType.CLICK,(function(){c.openURL("https://metacitym.com/")}),this),this.buylandBtn.on(r.EventType.CLICK,(function(){c.openURL("https://metacitym.com/")}),this),this.ntfStartBtn.on(r.EventType.CLICK,(function(){p.isLogin()?t.tokenIdScrollView.active?t.tokenIdScrollView.active=!1:t.tokenIdScrollView.active=!0:t.goToLoginUrl()}),this),this.loginButton.on(r.EventType.CLICK,(function(){console.log("login click"),t.goToLoginUrl()}),this),this.logoutButton.on(r.EventType.CLICK,(function(){console.log("logout click"),location.href="https://metacitym.com/map/?language="+p.language}),this),this.initRequestData()},s.goToLoginUrl=function(){p.language?location.href="https://metacitym.com/login/index.html?redirect=https://metacitym.com/map/?language="+p.language:location.href="https://metacitym.com/login/index.html?redirect=https://metacitym.com/map/"},s.initRequestData=function(){p.isLogin()?(this.tokenIdScrollView.active=!0,this.loginButton.active=!1,this.logoutButton.active=!0,this.startRequestData()):(this.tokenIdScrollView.active=!1,this.loginButton.active=!0,this.logoutButton.active=!1)},s.startRequestData=function(){var t=i(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.loadingLabelNode.active=!0,t.next=3,this.sleep(1e3);case 3:this.requestTokenIds(p.address,null,1);case 4:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),s.createTokenIdView=function(){var t=this;console.log("createTokenIdView"),this.tokenIds.length>0?(this.tipsLabelNode.active=!1,d.load("Prefab/TokenIdItem",h,(function(e,n){e&&console.log(e),t.tokenIdScrollViewContentNode.removeAllChildren();var o=(u(n).getComponent(g).height+10)*(t.tokenIds.length+1);t.tokenIdScrollViewContentNode.getComponent(g).height=o,t.refreshTokenUi(n)})),this.showLightOnMap()):this.tipsLabelNode.active=!0},s.refreshTokenUi=function(t){for(var e=0;e<this.tokenIds.length;e++){var n=this.tokenIds[e],o=u(t);o.getChildByName("tokenIdLabel").getComponent(f).string=n+"",o.getComponent(r).clickEvents[0].customEventData=n+"",this.tokenIdScrollViewContentNode.addChild(o)}},s.showLightOnMap=function(){this.lightIndex=0,this.showLightOnMapLoop()},s.showLightOnMapLoop=function(){var t=this;if(this.tokenIds.length>0){var e=this.tokenIds[this.lightIndex];I.getDataAndShowLandTips(e,!0,(function(){t.lightIndex<t.tokenIds.length-1&&(t.lightIndex=t.lightIndex+1,t.showLightOnMapLoop())}))}},s.requestTokenIds=function(t,e,n){var o=this;if(1==n||e){var i="";i=1!=n&&e?"https://act.gamamobi.com/pre/nft/getTokenIds.web?owner="+t+"&pageKey="+e+"&contractAddress=0x82016d4ad050ef4784e282b82a746d3e01df23bf,0xa39853A45D0420D8dB0F660EA39dA1E89608fCfa&_="+Date.parse((new Date).toString()):"https://act.gamamobi.com/pre/nft/getTokenIds.web?owner="+t+"&contractAddress=0x82016d4ad050ef4784e282b82a746d3e01df23bf,0xa39853A45D0420D8dB0F660EA39dA1E89608fCfa&_="+Date.parse((new Date).toString()),m.httpPequest(i,(function(e){if(e){var i=JSON.parse(e),a=i.ownedNfts,s=i.pageKey;i.totalCount,i.blockHash;if(a)for(var l=0;l<a.length;l++){var r=a[l].id.tokenId,c=m.hex2Number(r);c&&r&&o.tokenIds.push(c)}s?o.requestTokenIds(t,s,2):(console.log("全部请求完成"),o.loadingLabelNode.active=!1,o.tokenIds.length>0&&o.tokenIds.sort((function(t,e){return t-e})),o.createTokenIdView()),console.log("解析完成 key="+s)}else console.log("request error:"+n),o.loadingLabelNode.active=!1,o.tipsLabelNode.active=!0}))}},a}(k))||v);a._RF.pop()}}}));

System.register("chunks:///_virtual/CUtil.ts",["cc","./MapController.ts"],(function(e){"use strict";var t,n,o,r,s;return{setters:[function(e){t=e.cclegacy,n=e._decorator,o=e.view,r=e.Vec3},function(e){s=e.MapController}],execute:function(){var i;t._RF.push({},"51648wVQwlFzoh7MuSIErH4","CUtil",void 0);var a=n.ccclass;n.property,e("CUtil",a("CUtil")(i=function(){function e(){}return e.getScaleRatio=function(){var e=o.getVisibleSizeInPixel(),t=o.getDesignResolutionSize(),n=e.width,s=e.height;if(console.log("nVisibleSizeInPixel =",e),console.log("nDesignResolutionSize =",t),s>n){var i=n/t.width;if(i<1)return new r(i,i,i)}return null},e.getLocalString=function(e){var t=s.languageDic[e];return t||e},e.getQueryVariable=function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),n=window.location.search.substring(1).match(t);return null!=n?decodeURI(n[2]):null},e.httpPequest=function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(console.log("onreadystatechange"),4==n.readyState&&n.status>=200&&n.status<400){var e=n.responseText;t(e)}},n.open("GET",e,!0),n.withCredentials=!0,n.send()},e.loadRequest=function(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(4==n.readyState&&n.status>=200&&n.status<400){var e=n.response;return console.log("loadRequest response:"+e),void t(e)}t(null)},n.open("GET",e,!0),n.withCredentials=!0,n.send()},e.httpPostPequest=function(e,t){var n=new XMLHttpRequest;n.timeout=5e3,n.open("POST",e,!0),n.setRequestHeader("Authorization","true"),n.onerror=function(e){console.log("onerror")},n.onreadystatechange=function(){4===n.readyState&&n.status>=200&&n.status<300?(console.log("success"),console.log(n.responseText)):console.log("fail")},n.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=utf-8");n.send("jQuery18206190064924153293_1646388734858&owner=0x2f2e99bcbe39D8407552E821e7F4F0F9592Dfcab&contractAddress=0x82016d4ad050ef4784e282b82a746d3e01df23bf&_=1646388740791")},e.hex2Number=function(e){return void 0===e&&(e=""),0===e.indexOf("0x")&&(e=e.slice(2)),parseInt("0x"+e,16)},e}())||i);t._RF.pop()}}}));

System.register("chunks:///_virtual/LandTipsNode2Component.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./LandInfoTipsComponent.ts","./MapController.ts","./BaseComponent.ts"],(function(t){"use strict";var n,e,o,i,s,a,l,c,r,h,p,d;return{setters:[function(t){n=t.inheritsLoose,e=t.defineProperty,o=t.assertThisInitialized},function(t){i=t.cclegacy,s=t._decorator,a=t.find,l=t.Button,c=t.Sprite,r=t.Color},function(t){h=t.LandInfoTipsComponent},function(t){p=t.MapController},function(t){d=t.BaseComponent}],execute:function(){var u;i._RF.push({},"550a6iIGkpCaoRV/fQjOrY5","LandTipsNode2Component",void 0);var C=s.ccclass;s.property,t("LandTipsNode2Component",C("LandTipsNode2Component")(u=function(t){function i(){for(var n,i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n=t.call.apply(t,[this].concat(s))||this,e(o(n),"previous",null),e(o(n),"next",null),e(o(n),"closeBtn",null),e(o(n),"lightTokenIds",null),e(o(n),"landShowInfoNode",null),e(o(n),"index",0),e(o(n),"callback",null),n}n(i,t);var s=i.prototype;return s.start=function(){var n=this;if(t.prototype.start.call(this),this.previous=a("previous",this.node),this.next=a("next",this.node),this.closeBtn=a("btn_close",this.node),a("nfts_bg/closeButton",this.node).active=!1,this.landShowInfoNode=a("nfts_bg",this.node),this.closeBtn.on(l.EventType.CLICK,(function(){p.mapCanMove=!0,p.mapCanScale=!0,n.callback&&n.callback(1),n.node.removeFromParent(),n.node.destroy()})),this.previous.on(l.EventType.CLICK,(function(){n.index<0||(n.index=n.index-1,n.showData(n.lightTokenIds[n.index]),n.checkBtnStatue())})),this.next.on(l.EventType.CLICK,(function(){n.index>n.lightTokenIds.length-1||(n.index=n.index+1,n.showData(n.lightTokenIds[n.index]),n.checkBtnStatue())})),p.mapCanMove=!1,p.mapCanScale=!1,this.lightTokenIds.length>0){var e=this.lightTokenIds[0];this.showData(e)}this.checkBtnStatue()},s.setData=function(t){this.lightTokenIds=t},s.showData=function(t){var n=this;p.getDataAndShowLandTips(t,!1,(function(t,e,o){n.landShowInfoNode.getComponent(h).updateDatas(t+"",e,o)}))},s.checkBtnStatue=function(){0==this.index?(this.previous.getComponent(c).color=r.GRAY,this.previous.getComponent(l).interactable=!1):(this.previous.getComponent(c).color=r.WHITE,this.previous.getComponent(l).interactable=!0),this.index>=this.lightTokenIds.length-1?(this.next.getComponent(c).color=r.GRAY,this.next.getComponent(l).interactable=!1):(this.next.getComponent(c).color=r.WHITE,this.next.getComponent(l).interactable=!0)},i}(d))||u);i._RF.pop()}}}));

System.register("chunks:///_virtual/LandInfoTipsComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MapController.ts","./CUtil.ts","./BaseComponent.ts"],(function(t){"use strict";var e,n,o,i,a,r,l,s,d,c,p,f,u,h,m,g,v,N,C,S;return{setters:[function(t){e=t.inheritsLoose,n=t.defineProperty,o=t.assertThisInitialized,i=t.createForOfIteratorHelperLoose},function(t){a=t.cclegacy,r=t._decorator,l=t.find,s=t.Node,d=t.Label,c=t.Sprite,p=t.Button,f=t.resources,u=t.Prefab,h=t.instantiate,m=t.assetManager,g=t.SpriteFrame,v=t.Texture2D},function(t){N=t.MapController},function(t){C=t.CUtil},function(t){S=t.BaseComponent}],execute:function(){var _;a._RF.push({},"58db7uTBt5Pr5RYW2ZPCYKZ","LandInfoTipsComponent",void 0);var b=r.ccclass;r.property,t("LandInfoTipsComponent",b("LandInfoTipsComponent")(_=function(t){function a(){for(var e,i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];return e=t.call.apply(t,[this].concat(a))||this,n(o(e),"titleLabe",null),n(o(e),"proScrollView_contentNode",null),n(o(e),"proScrollView",null),n(o(e),"ntfsNode",null),n(o(e),"imgSprite",null),n(o(e),"closeNode",null),n(o(e),"bgNode",null),n(o(e),"tokenId",null),n(o(e),"imageUrl",null),n(o(e),"landDatas",null),n(o(e),"land_name",null),e}e(a,t);var r=a.prototype;return r.reset=function(){},r.start=function(){var e=this;"LandTipsNode2"!=this.node.getParent().name&&t.prototype.start.call(this),this.ntfsNode=this.node;var n=l("TestButton",this.ntfsNode);this.bgNode=l("bgNode",this.ntfsNode),this.bgNode.on(s.EventType.TOUCH_MOVE,(function(){}));var o=l("titleLabel",this.ntfsNode);this.titleLabe=o.getComponent(d),this.closeNode=l("closeButton",this.ntfsNode),this.imgSprite=l("nfts_img_Sprite",this.ntfsNode).getComponent(c),this.proScrollView=l("proScrollView",this.ntfsNode),this.proScrollView_contentNode=l("view/content",this.proScrollView),n.on(p.EventType.CLICK,(function(){f.load("Prefab/proItemNodePrefab",u,(function(t,n){t&&console.log(t);var o=h(n);e.proScrollView_contentNode.addChild(o)}))}),this),this.closeNode.on(p.EventType.CLICK,(function(){e.node&&N.resetCityInfoState()}),this),!this.land_name&&this.landDatas?C.httpPequest("https://metacitym.gamamobi.com/mcm/api/land?token="+this.tokenId,(function(t){if(t){var n=JSON.parse(t);if(n){var o=n.attributes;if(o)for(var i=0;i<o.length;i++){var a=o[i];if("land_name"==a.trait_type){e.land_name=a.value;break}}}}e.updateDatas(e.tokenId,e.imageUrl,e.landDatas)})):this.updateDatas(this.tokenId,this.imageUrl,this.landDatas)},r.updateDatas=function(t,e,n){var o=this;if(this.tokenId=t,this.imageUrl=e,this.landDatas=n,this.land_name?this.landDatas.set(C.getLocalString("land_name"),this.land_name):this.landDatas.set(C.getLocalString("land_name"),""),this.ntfsNode){this.titleLabe.string="TokenID:"+t;var a=this;console.log("loadRemote imageUrl=",e),m.loadRemote(e,{xhrWithCredentials:!0},(function(t,e){if(t)console.log(t);else if(e){var n=new g,o=new v;o.image=e,n.texture=o,n&&a&&a.imgSprite&&a.imgSprite.spriteFrame&&(a.imgSprite.spriteFrame=n)}})),this.proScrollView_contentNode.removeAllChildren(),f.load("Prefab/proItemNodePrefab",u,(function(t,e){if(t)console.log(t);else{o.proScrollView_contentNode.removeAllChildren();for(var a,r=i(n);!(a=r()).done;){var s=a.value,c=s[0],p=s[1],f=h(e),u=l("itemNameLabel",f).getComponent(d),m=l("itemValueLabel",f).getComponent(d);u.string=c,m.string=p,o.proScrollView_contentNode.addChild(f)}}}))}},r.setTitleText=function(t){return"<color=#00FFDE>"+t+"</color>"},r.setValueText=function(t){return"<color=#ffffff>"+t+"</color>"},a}(S))||_);a._RF.pop()}}}));

System.register("chunks:///_virtual/SLightComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MainGame.ts","./LandTipsNode2Component.ts","./MapController.ts"],(function(t){"use strict";var e,i,n,o,s,l,a,r,h,c,p,u,f,d,g,m,_;return{setters:[function(t){e=t.inheritsLoose,i=t.defineProperty,n=t.assertThisInitialized},function(t){o=t.cclegacy,s=t._decorator,l=t.AnimationComponent,a=t.Sprite,r=t.find,h=t.Button,c=t.resources,p=t.Prefab,u=t.instantiate,f=t.SpriteFrame,d=t.Component},function(t){g=t.MainGame},function(t){m=t.LandTipsNode2Component},function(t){_=t.MapController}],execute:function(){var k;o._RF.push({},"6be49OU6OVJD7Szbc8b5Jwc","SLightComponent",void 0);var v=s.ccclass;s.property,t("SLightComponent",v("SLightComponent")(k=function(t){function o(){for(var e,o=arguments.length,s=new Array(o),l=0;l<o;l++)s[l]=arguments[l];return e=t.call.apply(t,[this].concat(s))||this,i(n(e),"lightTokenIds",[]),i(n(e),"lisaData",null),i(n(e),"tokenIdMapCityInfo",{}),i(n(e),"parent",null),i(n(e),"lightBgSprite",null),i(n(e),"lightBgClick",0),i(n(e),"type",3),i(n(e),"flashNode",null),i(n(e),"flashSprite",null),e}e(o,t);var s=o.prototype;return s.setLisaData=function(t){this.lisaData=t},s.startFlash=function(){this.flashNode?(console.log("flashNode startFlash"),this.flashNode.active=!0,this.flashNode.getComponent(l).play()):console.log("flashNode is null")},s.reset=function(){this.lightBgClick=0,this.setNormalStatue()},s.doClick=function(){this.lightBgClick=1,this.setClickStatue(),_.clickNodeOfSLightComponent=this},s.start=function(){var t=this;this.parent=g.find("UIParent"),this.lightBgSprite=this.node.getComponent(a),this.flashNode=r("pink_flash",this.node),this.flashSprite=this.flashNode.getComponent(a),this.node.on(h.EventType.CLICK,(function(){console.log("slight click = ",t.lightBgClick),3==t.type&&t.lisaData&&(_.getDataAndShowCityTips(t.lisaData.cityId,(function(){_.resetCityInfoState()})),t.doClick())})),this.flashNode.on(h.EventType.CLICK,(function(){console.log("flash click = ",t.lightBgClick),t.lightTokenIds.length>0&&(console.log("lightTokenIds = ",t.lightTokenIds),_.resetCityInfoState(),c.load("Prefab/LandTipsNode2",p,(function(e,i){e&&console.log(e);var n=u(i),o=n.getComponent(m);o.setData(t.lightTokenIds),o.callback=function(t){_.resetCityInfoState()},t.parent.addChild(n),_.mAlertView=n,t.doClick(),_.setTouchMove(n)})))}))},s.addTokenId=function(t,e){this.lightTokenIds.push(t),this.type=e},s.setClickStatue=function(){var t=this,e="Texture/pink_100x100v_click/spriteFrame";if(1==this.type?e="Texture/yellow_100x100v_click/spriteFrame":2==this.type?e="Texture/white_100x100v_click/spriteFrame":3==this.type&&(e="Texture/pink_100x100v_click/spriteFrame"),c.load(e,f,(function(e,i){e?console.log(e):t.lightBgSprite.spriteFrame=i})),this.node.active){var i="Texture/pink_100x100v_flash_click/spriteFrame";1==this.type?i="Texture/yellow_100x100v_flash_click/spriteFrame":2==this.type?i="Texture/white_100x100v_flash_click/spriteFrame":3==this.type&&(i="Texture/pink_100x100v_flash_click/spriteFrame"),c.load(i,f,(function(e,i){e?console.log(e):t.flashSprite.spriteFrame=i}))}},s.setNormalStatue=function(){var t=this,e="Texture/pink_100x100v_normal/spriteFrame";if(1==this.type?e="Texture/yellow_100x100v_normal/spriteFrame":2==this.type?e="Texture/white_100x100v_normal/spriteFrame":3==this.type&&(e="Texture/pink_100x100v_normal/spriteFrame"),c.load(e,f,(function(e,i){e?console.log(e):t.lightBgSprite.spriteFrame=i})),this.node.active){var i="Texture/pink_100x100v_flash/spriteFrame";1==this.type?i="Texture/yellow_100x100v_flash/spriteFrame":2==this.type?i="Texture/white_100x100v_flash/spriteFrame":3==this.type&&(i="Texture/pink_100x100v_flash/spriteFrame"),c.load(i,f,(function(e,i){e?console.log(e):t.flashSprite.spriteFrame=i}))}},o}(d))||k);o._RF.pop()}}}));

System.register("chunks:///_virtual/LisaCityInfoTipsComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MapController.ts","./CUtil.ts","./BaseComponent.ts"],(function(t){"use strict";var e,o,n,i,r,l,a,c,s,g,f,p,u,m,C,y,h,L,d;return{setters:[function(t){e=t.inheritsLoose,o=t.defineProperty,n=t.assertThisInitialized,i=t.createForOfIteratorHelperLoose},function(t){r=t.cclegacy,l=t._decorator,a=t.UITransform,c=t.find,s=t.Button,g=t.resources,f=t.SpriteFrame,p=t.Sprite,u=t.Prefab,m=t.instantiate,C=t.Label,y=t.Color},function(t){h=t.MapController},function(t){L=t.CUtil},function(t){d=t.BaseComponent}],execute:function(){var v;r._RF.push({},"6e845D3U/tNO7X1uUUPrS6/","LisaCityInfoTipsComponent",void 0);var S=l.ccclass;l.property,t("LisaCityInfoTipsComponent",S("LisaCityInfoTipsComponent")(v=function(t){function r(){for(var e,i=arguments.length,r=new Array(i),l=0;l<i;l++)r[l]=arguments[l];return e=t.call.apply(t,[this].concat(r))||this,o(n(e),"cityHomeScrollViewContent",null),o(n(e),"closeButton",null),o(n(e),"homeCityBg",null),o(n(e),"infoData",null),o(n(e),"cityLevel",0),o(n(e),"callback",null),o(n(e),"isLisa",!0),o(n(e),"orginUITransform",null),e}e(r,t);var l=r.prototype;return l.start=function(){var e=this;if(t.prototype.start.call(this),this.orginUITransform=this.node.getComponent(a),this.homeCityBg=c("homeCityBg",this.node),this.cityHomeScrollViewContent=c("cityHomeScrollView/view/content",this.node),this.closeButton=c("btn_close",this.node),this.closeButton.on(s.EventType.CLICK,(function(){e.callback&&e.callback(),e.node.removeFromParent(),e.node.destroy(),h.resetCityInfoState()})),this.isLisa){var o="Texture/LisaCityLevel_1/spriteFrame";2==this.cityLevel&&(o="Texture/LisaCityLevel_2/spriteFrame"),g.load(o,f,(function(t,o){t?console.log(t):e.homeCityBg&&(e.homeCityBg.getComponent(p).spriteFrame=o)}))}else{var n="Texture/CityLevel_1/spriteFrame";2==this.cityLevel&&(n="Texture/CityLevel_2/spriteFrame"),g.load(n,f,(function(t,o){t?console.log(t):e.homeCityBg&&(e.homeCityBg.getComponent(p).spriteFrame=o)}))}this.infoData&&g.load("Prefab/itemRichText",u,(function(t,o){if(t)console.log(t);else if(e.cityHomeScrollViewContent)for(var n,r=0,l=1,s=i(e.infoData);!(n=s()).done;){var g=n.value,f=g[0],p=g[1],u=m(o);0==r&&(r=u.getComponent(a).height,e.cityHomeScrollViewContent.getComponent(a).height=(e.infoData.size+1)*(r+10));var h=c("xxLabel",u),L="";l>4?(L=f+" : "+p,h.getComponent(C).color=new y("#ff48da")):L=f+" : "+p,h.getComponent(C).string=L,e.cityHomeScrollViewContent.addChild(u),l+=1}}))},l.update=function(t){},l.updateData=function(t,e,o,n,i,r,l,a,c,s,g,f,p){console.log("updateData"),this.isLisa=t,this.cityLevel=l,this.infoData=t?new Map([[L.getLocalString("planet"),o],[L.getLocalString("city"),n],[L.getLocalString("total_land"),i],[L.getLocalString("city_level"),l+""],[L.getLocalString("land_name"),"Lisa‘s Home"],[L.getLocalString("tokenId"),a],[L.getLocalString("land_level"),c],[L.getLocalString("town"),s],[L.getLocalString("land_no"),g+""],[L.getLocalString("land_posx"),f+""],[L.getLocalString("land_posy"),p+""]]):new Map([[L.getLocalString("planet"),o],[L.getLocalString("city"),n],[L.getLocalString("total_land"),i],[L.getLocalString("city_level"),l+""]])},l.getRichString=function(t,e){return"<color=#00fff6>"+t+"</color><color=#00fff6>"+e+"</color>"},l.getRichString2=function(t,e){return"<color=#ff48da>"+t+"</color><color=#ff48da>"+e+"</color>"},r}(d))||v);r._RF.pop()}}}));

System.register("chunks:///_virtual/CityInfoTipsComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MapController.ts","./BaseComponent.ts"],(function(t){"use strict";var e,n,i,o,r,a,l,s,c,h,u,p,y;return{setters:[function(t){e=t.inheritsLoose,n=t.defineProperty,i=t.assertThisInitialized},function(t){o=t.cclegacy,r=t._decorator,a=t.find,l=t.Button,s=t.RichText,c=t.resources,h=t.SpriteFrame,u=t.Sprite},function(t){p=t.MapController},function(t){y=t.BaseComponent}],execute:function(){var d;o._RF.push({},"9fdefjZUENB74GLtfl0NkNU","CityInfoTipsComponent",void 0);var g=r.ccclass;r.property,t("CityInfoTipsComponent",g("CityInfoTipsComponent")(d=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(i(e),"landBg",null),n(i(e),"planetText",null),n(i(e),"cityText",null),n(i(e),"totalLandText",null),n(i(e),"cityGradeText",null),n(i(e),"closeButton",null),n(i(e),"cityBgNode",null),n(i(e),"mParent",null),n(i(e),"url",null),n(i(e),"planet",null),n(i(e),"cityName",null),n(i(e),"totalLand",null),n(i(e),"cityGrade",null),n(i(e),"cityLevel",0),e}e(o,t);var r=o.prototype;return r.start=function(){var e=this;t.prototype.start.call(this),this.mParent=this.node,this.landBg=a("land_bg",this.mParent),this.planetText=a("city_info/PlanetRichText",this.mParent),this.cityText=a("city_info/CityRichText",this.mParent),this.totalLandText=a("city_info/TotalLandRichText",this.mParent),this.cityGradeText=a("city_info/CityGradeRichText",this.mParent),this.closeButton=a("btn_close",this.mParent),this.cityBgNode=a("land_bg/cityBg",this.mParent),this.closeButton.on(l.EventType.CLICK,(function(){e.mParent.removeFromParent(),e.mParent.destroy(),p.resetCityInfoState()})),console.log("CityInfoTipsComponent start"),this.planetText.getComponent(s).string=this.getRichString("Planet: ",this.planet),this.cityText.getComponent(s).string=this.getRichString("City: ",this.cityName),this.totalLandText.getComponent(s).string=this.getRichString("TotalLand: ",this.totalLand),this.cityGradeText.getComponent(s).string=this.getRichString("City Grade: ",this.cityGrade),2==this.cityLevel&&c.load("Texture/CityLevel_2/spriteFrame",h,(function(t,n){t?console.log(t):e.cityBgNode.getComponent(u).spriteFrame=n}))},r.updateData=function(t,e,n,i,o,r){console.log("updateData"),this.url=t,this.planet=e,this.cityName=n,this.totalLand=i,this.cityGrade=o,this.cityLevel=r},r.getRichString=function(t,e){return"<color=#00f1e8>"+t+"</color><color=#f0b432>"+e+"</color>"},o}(y))||d);o._RF.pop()}}}));

System.register("chunks:///_virtual/BaseComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./CUtil.ts"],(function(e){"use strict";var t,c,n,s,o,i,a,r;return{setters:[function(e){t=e.inheritsLoose,c=e.defineProperty,n=e.assertThisInitialized},function(e){s=e.cclegacy,o=e._decorator,i=e.Vec3,a=e.Component},function(e){r=e.CUtil}],execute:function(){var l;s._RF.push({},"ac51eX5j+NKjKI5FKfQ0Ixa","BaseComponent",void 0);var u=o.ccclass;o.property,e("BaseComponent",u("BaseComponent")(l=function(e){function s(){for(var t,s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o))||this,c(n(t),"scaleVec3",void 0),t}return t(s,e),s.prototype.start=function(){if(this.scaleVec3=r.getScaleRatio(),this.scaleVec3){var e=this.node.getScale(),t=new i(this.scaleVec3.x*e.x,this.scaleVec3.y*e.y,this.scaleVec3.z*e.z);this.node.setScale(t)}},s}(a))||l);s._RF.pop()}}}));

System.register("chunks:///_virtual/LanguageComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MainGame.ts"],(function(e){"use strict";var n,a,t,o,g,i,l,u,s;return{setters:[function(e){n=e.inheritsLoose,a=e.defineProperty,t=e.assertThisInitialized},function(e){o=e.cclegacy,g=e._decorator,i=e.find,l=e.Button,u=e.Component},function(e){s=e.MainGame}],execute:function(){var c;o._RF.push({},"b82b4M4t+9He5NGuP9cXEIj","LanguageComponent",void 0);var d=g.ccclass;g.property,e("LanguageComponent",d("LanguageComponent")(c=function(e){function o(){for(var n,o=arguments.length,g=new Array(o),i=0;i<o;i++)g[i]=arguments[i];return n=e.call.apply(e,[this].concat(g))||this,a(t(n),"changeLanguageNode",null),a(t(n),"languageContentNode",null),a(t(n),"languageBgNode",null),a(t(n),"zhLabelNode",null),a(t(n),"enLabelNode",null),a(t(n),"krLabelNode",null),a(t(n),"jpLabelNode",null),a(t(n),"taiLabelNode",null),n}n(o,e);var g=o.prototype;return g.start=function(){var e=this;this.changeLanguageNode=i("language_select",this.node),this.languageBgNode=i("language_bg",this.node),this.languageContentNode=i("language_bg/languageScrollView/view/content",this.node),this.zhLabelNode=i("zhLabel",this.languageContentNode),this.enLabelNode=i("enLabel",this.languageContentNode),this.krLabelNode=i("krLabel",this.languageContentNode),this.jpLabelNode=i("jpLabel",this.languageContentNode),this.taiLabelNode=i("taiLabel",this.languageContentNode),this.changeLanguageNode.on(l.EventType.CLICK,(function(){e.languageBgNode.active?e.languageBgNode.active=!1:e.languageBgNode.active=!0})),this.zhLabelNode.on(l.EventType.CLICK,(function(){e.languageBgNode.active=!1,e.switchTo("zh_TW")})),this.enLabelNode.on(l.EventType.CLICK,(function(){e.languageBgNode.active=!1,e.switchTo("en")})),this.krLabelNode.on(l.EventType.CLICK,(function(){e.languageBgNode.active=!1,e.switchTo("kr")})),this.taiLabelNode.on(l.EventType.CLICK,(function(){e.languageBgNode.active=!1,e.switchTo("th")})),this.jpLabelNode.on(l.EventType.CLICK,(function(){e.languageBgNode.active=!1,e.switchTo("jp")}))},g.switchTo=function(e){var n="https://metacitym.com/map/?language="+e;s.isLogin()&&(n=n+"&address="+s.address),s.language=e,location.href=n},o}(u))||c);o._RF.pop()}}}));

System.register("chunks:///_virtual/TokenIdButtonComponent.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./MainGame.ts","./LandTipsNode2Component.ts","./SLightComponent.ts","./MapController.ts"],(function(t){"use strict";var n,e,o,i,r,a,c,s,l,u,p,d,f,g,h;return{setters:[function(t){n=t.inheritsLoose,e=t.defineProperty,o=t.assertThisInitialized},function(t){i=t.cclegacy,r=t._decorator,a=t.find,c=t.Button,s=t.resources,l=t.Prefab,u=t.instantiate,p=t.Component},function(t){d=t.MainGame},function(t){f=t.LandTipsNode2Component},function(t){g=t.SLightComponent},function(t){h=t.MapController}],execute:function(){var C;i._RF.push({},"e341c7WxlRBm6lvXLdHjCUg","TokenIdButtonComponent",void 0);var m=r.ccclass;r.property,t("TokenIdButtonComponent",m("TokenIdButtonComponent")(C=function(t){function i(){for(var n,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];return n=t.call.apply(t,[this].concat(r))||this,e(o(n),"bgNode",null),e(o(n),"parent",null),e(o(n),"clicking",0),n}n(i,t);var r=i.prototype;return r.reset=function(){this.bgNode.active=!1},r.start=function(){this.parent=d.find("UIParent"),this.bgNode=a("white_bg",this.node)},r.btnClickCallback=function(t,n){var e=this;if(1!=this.clicking){t.target.getComponent(c);console.log(n);var o=parseInt(n);h.resetCityInfoState();var i=[o],r=h.lightPosWithTokenId[o];r&&(this.clicking=1,s.load("Prefab/LandTipsNode2",l,(function(t,n){e.clicking=0,t&&console.log(t),h.resetCityInfoState();var o=u(n),a=o.getComponent(f);a.setData(i),a.callback=function(t){h.resetCityInfoState()},e.parent.addChild(o),h.mAlertView=o,h.setTouchMove(o);var c=r.x+"_"+r.y,s=h.lightPosWithLightNode[c];s&&s.getComponent(g).doClick()})))}},i}(p))||C);i._RF.pop()}}}));

System.register("chunks:///_virtual/MainGame.ts",["./_rollupPluginModLoBabelHelpers.js","cc","./UIController.ts","./MapController.ts","./CUtil.ts"],(function(n){"use strict";var a,e,t,r,i,s,l,u,o;return{setters:[function(n){a=n.defineProperty,e=n.inheritsLoose},function(n){t=n.cclegacy,r=n._decorator,i=n.find,s=n.Component},function(n){l=n.UIController},function(n){u=n.MapController},function(n){o=n.CUtil}],execute:function(){var c,d,f;t._RF.push({},"fc1783xF95ARYakZeB0C/v9","MainGame",void 0);var m=r.ccclass;n("MainGame",m("MainGame")((f=d=function(n){function a(){return n.apply(this,arguments)||this}e(a,n),a.find=function(n){return i(n,a.mainCanvas)},a.isLogin=function(){return!(!a.address||""==a.address||"null"==a.address)};var t=a.prototype;return t.start=function(){a.mainCanvas=i("Canvas"),a.mainCamera=i("Camera",a.mainCanvas),a.address=o.getQueryVariable("address"),a.language=o.getQueryVariable("language"),a.language||(a.language="en"),u.init(),l.init()},t.update=function(n){a.deltaTime=n},a}(s),a(d,"mainCamera",null),a(d,"mainCanvas",null),a(d,"deltaTime",0),a(d,"address",null),a(d,"language",null),c=f))||c);t._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./UIController.ts","./MainGame.ts","./LandInfoTipsComponent.ts","./LandTipsNode2Component.ts","./SLightComponent.ts","./LisaCityInfoTipsComponent.ts","./MapController.ts","./CUtil.ts","./BaseComponent.ts","./UIParentComponent.ts","./SPageViewComponent.ts","./TokenIdModel.ts","./LoginInfoComponent.ts","./CityInfoTipsComponent.ts","./LanguageComponent.ts","./TokenIdButtonComponent.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});